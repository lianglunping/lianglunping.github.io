<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>GWAS相关知识</title>
      <link href="/2022/05/26/GWAS%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/05/26/GWAS%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>popLDdecay</title>
      <link href="/2022/05/17/popLDdecay/"/>
      <url>/2022/05/17/popLDdecay/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="连锁不平衡分析"><a class="markdownIt-Anchor" href="#连锁不平衡分析"></a> 连锁不平衡分析</h1><p>当位于某一座位的特定等位基因与另一座位的某一等位基因同时出现的概率不等于群体中 因随机分布的两个等位基因同时出现的概率时，就称这两个座位处于连锁不平衡状态 （linkage disequilibrium）</p><ol><li>LD 的计算方法与度量：</li></ol><p>设有两个位点 A、B，等位基因分别为 A、a 和 B、b，在群体中对应的频率分别为 f(A)、f(a) 和 f(B)、f(b)；两个位点共有 4 种单倍型 AB、Ab、aB 和 ab，对应的频率分别为 f(AB)、f(Ab)、 f(aB)和 f(ab)；<br />则有基本量：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{ab} = f(AB) - f(A)* f(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p><p>从 <code>0-1</code>，度量值越高，LD 越高，一般情况下，如果两个位点连锁，连锁程度也越强。</p><p>特殊说明： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>反映了 LD 的不同方面。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 包括了重组和突变，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>只包括重组史。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>能更准确地估测重组差异，但样本较小时，低频率等位基因组合可能无法观测到，导致 LD 强度被高 估，所以 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>不适合小样本群体研究。 当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，处于完全连锁平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mi mathvariant="normal">≠</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} ≠ 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，处于连锁不平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">D_{ab} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 时，处于完全连锁不平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mfrac><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">|D&#x27;| = \frac{D_{ab}}{min(f(AB), f(ab))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.414191em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.894191em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.41586em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mfrac><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>b</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mi>B</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">|D&#x27;| = \frac{D_{ab}}{min(f(Ab), f(aB))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.414191em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.894191em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.41586em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><mi>D</mi><mi>a</mi><mi>b</mi></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">r^2 = \frac{Dab}{f(A)*f(a)*f(B)*f(b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">|D&#x27;| = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r^2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时处于完全连锁平衡状态 ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|D&#x27;| = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r^2 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 时处于完全连锁不平衡状态</p><ol start="2"><li>LD 衰减影响因素</li></ol><ul><li><p>不同物种，LD 是不同基因座上等位基因非随机组合。但 LD 随世代的增加、重组次数的 增加而不断下降。所以，那些繁殖力强、时代间隔短的物种（例如，昆虫），其 LD 衰减的 速度是非常快的。</p></li><li><p>同一物种，不同群体类型，由于其遗传背景不同，LD 衰减速度也存在很大的差异。驯 化群体，群体遗传多样性下降，位点间的相关性（连锁程度）加强。所以，驯化程度越高，选择强度越大的群体，LD 衰减速越慢。同样，自然选择、遗传漂变导致的群体遗传多样性 下降，也会减慢 LD 衰减的速度。</p></li><li><p>在染色体的位置，染色体在不同位置的 LD 衰减距离是不同的。通常着丝粒区更难重组， 所以 LD 衰减更慢，而基因组上那些受选择的区域相比普通的区域，LD 衰减速度也是更慢 的。</p></li></ul><ol start="3"><li>应用：</li></ol><ul><li><p>LD 衰减速度，对群体特性的评估，与群体类型的特性（自然群体还是驯化群体，选择 强度大小）是相关的。</p></li><li><p>全基因组关联分析所用标记量 =基因组大小/LD 衰减距离</p></li><li><p>GWAS，功能 SNP 和 tag SNP，GWAS 检测到显著关联的区间后，则可以通过进一步绘 制局部的 LD   单体型块图，来进一步判断显著相关的 SNP 和目标基因间是否存在强 LD 关系。</p></li><li><p>STRUCTURE 分析的时候理论上必须输入不相关的位点。那么，就可以通过预估 LD 衰 减到 0.1 的距离，来判断标记间的距离必须大于多少才能保证标记间不具相关性（LD&lt;0.1）。</p></li></ul><h2 id="连锁不平衡分析-poplddecay"><a class="markdownIt-Anchor" href="#连锁不平衡分析-poplddecay"></a> 连锁不平衡分析-PopLDdecay</h2><p>LD decay 在群体遗传研究中是最重要和常见的分析内容之一，是衡量 LD 水平的重要指标。 特别在自花授粉的作物中，LD 衰减不仅能够反映作物驯化和育种历史，还能显示基因流现 象、选择区域等。 传统 LD 处理软件 Haploview 可以用来计算 LD、单倍型等，但上百万 snp 标记的计算会消 耗大量资源，本地运行往往会由于运行内存不足而崩溃。PopLDdecay 是一种简单有效的 LD 衰减分析软件，可计算和绘图（不是特别理想），以压缩包形式输入输出内容，相比其他软 件，更适合大数据量的计算和分析</p><h3 id="安装"><a class="markdownIt-Anchor" href="#安装"></a> 安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/BGI-shenzhen/PopLDdecay.git</span><br><span class="line"><span class="built_in">chmod</span> 755 configure;</span><br><span class="line">./configure;</span><br><span class="line">make;</span><br><span class="line"><span class="built_in">mv</span> PopLDdecay  ./bin/;</span><br></pre></td></tr></table></figure><h3 id="计算ld"><a class="markdownIt-Anchor" href="#计算ld"></a> 计算LD</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#2.1 For gatk VCF file deal, run PopLDdecay direct</span></span><br><span class="line">./bin/PopLDdecay  -InVCF  SNP.vcf.gz  -OutStat LDdecay   </span><br><span class="line"><span class="comment">#2.2 For plink [.ped .map], chang plink 2 genotype first  2) run PopLDdecay  </span></span><br><span class="line">perl bin/mis/plink2genotype.pl -inPED in.ped -inMAP in.map -outGenotype out.genotype ;   </span><br><span class="line">./bin/PopLDdecay -InGenotype out.genotype -OutStat LDdecay </span><br><span class="line"><span class="comment">#2.3 To Calculate the subgroup GroupA LDdecay in VCF Files   # put GroupA sample name into GroupA_sample.list</span></span><br><span class="line">./bin/PopLDdecay -InVCF -OutStat -SubPop GroupA_sample.list</span><br></pre></td></tr></table></figure><h3 id="绘图"><a class="markdownIt-Anchor" href="#绘图"></a> 绘图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#3.1 For one Population</span></span><br><span class="line">perl bin/Plot_OnePop.pl -inFile LDdecay.stat.gz -output Fig</span><br><span class="line"><span class="comment">#3.2 For one Population muti chr  # List Format [chrResultPathWay]</span></span><br><span class="line">perl bin/Plot_OnePop.pl -inList Chr.ReslutPath.List -output Fig</span><br><span class="line"><span class="comment">#3.3 For muti Population #List Format:[Pop.ResultPath  PopID ]</span></span><br><span class="line">perl bin/Plot_MutiPop.pl -inList Pop.ReslutPath.list -output Fig</span><br></pre></td></tr></table></figure><h3 id="实例"><a class="markdownIt-Anchor" href="#实例"></a> 实例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PopLDdecay -InVCF test.impute.vcf -OutStat <span class="built_in">test</span> -MaxDist 1000 -MAF 0.05 -OutType 2 </span><br><span class="line"><span class="comment">#-InVCF 输入 vcf 文件 </span></span><br><span class="line"><span class="comment">#-OutStat 输出前缀 </span></span><br><span class="line"><span class="comment">#-MaxDist 窗口 </span></span><br><span class="line"><span class="comment">#-MAF 次要等位基因频率 </span></span><br><span class="line"><span class="comment">#-OutType 输出类型 </span></span><br></pre></td></tr></table></figure><p><img src="HHZ1.stat.LD.stat.gz.png" alt="" /></p><p>主要结果是 test.stat.gz</p><p>其中每一列的含义如下：</p><p>第一列：距离</p><p>第二列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 值</p><p>第三列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>值</p><p>第四列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 值求和</p><p>第五列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>值求和</p><p>第六列：SNP 对</p><h3 id="ld-衰减图"><a class="markdownIt-Anchor" href="#ld-衰减图"></a> LD 衰减图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rm <span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line">LD <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./HHZ1.stat.LD.stat&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="operator">=</span>LD<span class="punctuation">,</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Dist<span class="operator">/</span><span class="number">1000</span><span class="punctuation">,</span>y<span class="operator">=</span>Mean_r.2<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.3368881</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.3366881</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span>lineend <span class="operator">=</span> <span class="string">&quot;butt&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">67</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.33668881</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.3368881</span><span class="punctuation">)</span><span class="punctuation">,</span>label<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;(67,0.3368881)&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>nudge_x <span class="operator">=</span> <span class="number">0.002</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>y<span class="operator">=</span><span class="built_in">expression</span><span class="punctuation">(</span>r<span class="operator">^</span><span class="punctuation">&#123;</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="punctuation">,</span>title <span class="operator">=</span> <span class="string">&quot;LD decay&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;Distance&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_x_continuous<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span><span class="number">300</span><span class="punctuation">)</span><span class="punctuation">,</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">300</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> p<span class="operator">+</span>theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 使主标题居中</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure><h2 id="连锁不平衡分析-plink"><a class="markdownIt-Anchor" href="#连锁不平衡分析-plink"></a> 连锁不平衡分析-plink</h2><p>plink 是进行连锁不平衡分析的主要工具，一般情况下需要两个基本的输入文件，后缀分别 为 ped 和 map。</p><h3 id="格式转换"><a class="markdownIt-Anchor" href="#格式转换"></a> 格式转换</h3><p>利用 plink 首先将 vcf 格式的文件转换为 ped 和 map 文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plink --vcf test.impute.vcf --recode ped --out <span class="built_in">test</span> </span><br></pre></td></tr></table></figure><p>test.ped</p><p><img src="CZL.ped.png" alt="" /></p><p>前 6 列分别代表 Family ID、Individual ID、Paternal ID、Maternal ID、 Sex (1=male; 2=female; other=unknown)、Phenotype，后面的每一行，每两列代表一种基因型。</p><p>test.map</p><p><img src="CZL1.map.png" alt="" /></p><p>分别代表染色体，SNP，遗传距离，物理位置</p><h3 id="ld-分析"><a class="markdownIt-Anchor" href="#ld-分析"></a> LD 分析</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">plink --map test.map --ped test.ped --noweb --allow-no-sex --allow-extra-chr --missing-genotype 0 --maf 0.05 --r2 --ld-window 999999 --ld-window-kb 1000 --ld-window-r2 0 --out <span class="built_in">test</span> </span><br><span class="line"><span class="comment">#--map map 文件 </span></span><br><span class="line"><span class="comment">#--ped ped 文件 </span></span><br><span class="line"><span class="comment">#--noweb 不进行网络检查 </span></span><br><span class="line"><span class="comment">#--allow-extra-chr 允许其他格式的染色体编号 </span></span><br><span class="line"><span class="comment">#--missing-genotype 缺失基因型编码 </span></span><br><span class="line"><span class="comment">#--maf 次要等位基因频率 </span></span><br><span class="line"><span class="comment">#--r2 输出 r2 </span></span><br><span class="line"><span class="comment">#--ld-window 窗口内 SNP 数目 </span></span><br><span class="line"><span class="comment">#--ld-window-kb 窗口大小 </span></span><br><span class="line"><span class="comment">#--ld-window-r2 窗口内最小 SNP </span></span><br><span class="line"><span class="comment">#--out 输出前缀 </span></span><br></pre></td></tr></table></figure><p>主要结果 test.ld</p><p><img src="CZL.LD.ld.png" alt="" /></p><p>各列含义如下：</p><ul><li><p>第一列代表第一个 SNP 所在染色体</p></li><li><p>第二列代表第一个 SNP 的物理位置</p></li><li><p>第三列代表第一个 SNP</p></li><li><p>第四列代表第二个 SNP 所在染色体</p></li><li><p>第五列代表第二个 SNP 的物理位置</p></li><li><p>第六列代表第二个 SNP</p></li><li><p>第七列代表 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>  值</p></li></ul><h3 id="结果整理"><a class="markdownIt-Anchor" href="#结果整理"></a> 结果整理</h3><p>利用脚本 decay_chrom.pl 进行结果汇总，代码如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">perl decay_chrom.pl test.ld test.r2 1000 </span><br><span class="line">test.ld 代表 LD 分析的结果文件 </span><br><span class="line">test.r2 整理汇总后的输出文件 </span><br><span class="line">1000 代表窗口大小，单位是 kb </span><br></pre></td></tr></table></figure><p><img src="CZL.r2.png" alt="" /></p><p>各列含义如下：</p><ul><li><p>第一列代表区域</p></li><li><p>第二列代表区域内 SNP 数目</p></li><li><p>第三列代表区域内 SNP 之间的距离</p></li><li><p>第四列代表区域内 SNP 之间的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>  值</p></li></ul><h3 id="ld-衰减图-2"><a class="markdownIt-Anchor" href="#ld-衰减图-2"></a> LD 衰减图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;E:/BaiduNetdiskWorkspace/NGS/LD/&quot;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;HHZ1.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;Test.gvcf.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>x <span class="operator">&lt;-</span> <span class="punctuation">(</span>data<span class="operator">$</span>Total_dis<span class="operator">*</span><span class="number">1000</span><span class="punctuation">)</span><span class="operator">/</span><span class="punctuation">(</span>data<span class="operator">$</span>Total_num<span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>y <span class="operator">&lt;-</span> <span class="punctuation">(</span>data<span class="operator">$</span>Total_R2<span class="punctuation">)</span><span class="operator">/</span><span class="punctuation">(</span>data<span class="operator">$</span>Total_num<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> data<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span>y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span>base_line_size <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span>base_size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.2728428</span> <span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.2728428</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span>lineend <span class="operator">=</span> <span class="string">&quot;butt&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">316</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.2728428</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.29</span><span class="punctuation">)</span><span class="punctuation">,</span>label<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;(316,0.27)&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>nudge_x <span class="operator">=</span> <span class="number">0.002</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Distance(kb)&quot;</span><span class="punctuation">,</span>y <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span>r<span class="operator">^</span><span class="punctuation">&#123;</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="punctuation">,</span>title <span class="operator">=</span> <span class="string">&quot;LD decay&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getvalue<span class="operator">=</span><span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>v<span class="operator">=</span><span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">&gt;=</span>v <span class="operator">&amp;</span> <span class="built_in">min</span><span class="punctuation">(</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">&lt;=</span>v<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">2</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>y<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">      <span class="keyword">if</span><span class="punctuation">(</span>y<span class="punctuation">[</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">&gt;</span>v <span class="operator">&amp;</span> y<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="operator">&lt;</span>v<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    approx<span class="punctuation">(</span>y<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">:</span>i<span class="punctuation">]</span><span class="punctuation">,</span>x<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">:</span>i<span class="punctuation">]</span><span class="punctuation">,</span>xout<span class="operator">=</span>v<span class="punctuation">)</span><span class="operator">$</span>y</span><br><span class="line">  <span class="punctuation">&#125;</span><span class="keyword">else</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="literal">NA</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;Test.LD.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>x <span class="operator">&lt;-</span> data<span class="operator">$</span>Total_dis<span class="operator">*</span><span class="number">1000</span><span class="operator">/</span>data<span class="operator">$</span>Total_num</span><br><span class="line">data<span class="operator">$</span>y <span class="operator">&lt;-</span> data<span class="operator">$</span>Total_R2<span class="operator">/</span>data<span class="operator">$</span>Total_num</span><br><span class="line">y_half <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>data<span class="operator">$</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">2</span></span><br><span class="line">decay_value <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>getvalue<span class="punctuation">(</span>data<span class="operator">$</span>x<span class="punctuation">,</span>data<span class="operator">$</span>y<span class="punctuation">,</span>y_half<span class="punctuation">)</span><span class="punctuation">,</span>getvalue<span class="punctuation">(</span>data<span class="operator">$</span>x<span class="punctuation">,</span>data<span class="operator">$</span>y<span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">result <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>y_half<span class="punctuation">,</span>decay_value<span class="punctuation">)</span> </span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>result<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;R2_half&quot;</span><span class="punctuation">,</span><span class="string">&quot;R2_half_Decay_Value&quot;</span><span class="punctuation">,</span><span class="string">&quot;0.1_Decay_Value&quot;</span><span class="punctuation">)</span> </span><br><span class="line">result</span><br></pre></td></tr></table></figure><h2 id="最终结果"><a class="markdownIt-Anchor" href="#最终结果"></a> 最终结果</h2><p>最终结果如下：<br /><img src="LD-decay.svg" alt="" /></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>rrBLUP使用</title>
      <link href="/2022/04/26/rrBLUP%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/04/26/rrBLUP%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="amat"><a class="markdownIt-Anchor" href="#amat"></a> A.mat</h2><p>函数<code>A.mat</code>从标记估计真实关系矩阵(<code>A</code>)。对于没有缺失数据的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>高密度标记，<code>A.mat</code>使用VanRaden ( 2008 )建议的第一个公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mrow><mi>W</mi><msup><mi>W</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mn>2</mn><munder><mo>∑</mo><mi>k</mi></munder><mrow><msub><mi>p</mi><mi>k</mi></msub><msub><mi>q</mi><mi>k</mi></msub></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">A=\frac{WW&#x27;}{2\sum_k{p_kq_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4146020000000004em;vertical-align:-0.9857100000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857100000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其1中，其中W的等位基因调用以群体均值为中心。Endelman和Jannink ( 2012 )研究表明，该公式具有可取的性质，其平均对角元素为1 + f，其中f为当前种群的近交系数。</p><h3 id="missing-marker-data"><a class="markdownIt-Anchor" href="#missing-marker-data"></a> Missing marker data</h3><p>当基因型缺失时，<code>A.mat</code>有两个插补选项。一种是用该标记的总体均值来替换缺失数据，这对于SNP芯片通常遇到的低水平缺失数据是足够的。对于基因分型测序(GBS)标记而言，缺失数据的水平更高。针对这种情况，<code>A.mat</code>可以利用基于多元正态分布( 波兰等国 2012年 )的EM算法估计关系矩阵。</p><p>为了说明EM算法，我在Poland等人( 2012 )<a href="https://www.crops.org/publications/tpg/supplements/5/tpg12-06-0006-dataset-s2.gz">发布的补充文件</a>中下载了GBS数据,下面的R代码读取文件并将标记调用转换为rrBLUP期望的{ -1，0，1 }格式：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GBS<span class="operator">&lt;-</span>read.csv<span class="punctuation">(</span><span class="string">&quot;tpg12-06-0006-dataset-s2&quot;</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>as.is<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>row.names<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span>  </span><br><span class="line">parse.GBS <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="punctuation">&#123;</span> </span><br><span class="line">    unique.x <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>x<span class="punctuation">)</span> </span><br><span class="line">    alleles <span class="operator">&lt;-</span> setdiff<span class="punctuation">(</span>unique.x<span class="punctuation">,</span>union<span class="punctuation">(</span><span class="string">&quot;H&quot;</span><span class="punctuation">,</span><span class="string">&quot;N&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">    y <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span>alleles<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="operator">-</span><span class="number">1</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span>alleles<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span><span class="string">&quot;N&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span> </span><br><span class="line">    <span class="built_in">return</span><span class="punctuation">(</span>y<span class="punctuation">)</span> </span><br><span class="line"><span class="punctuation">&#125;</span> </span><br><span class="line">X <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>GBS<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span>parse.GBS<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>X<span class="punctuation">)</span>  </span><br><span class="line">frac.missing <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>X<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="keyword">function</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">&#123;</span><span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="built_in">length</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span> </span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>frac.missing<span class="operator">&lt;</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">hist<span class="punctuation">(</span>frac.missing<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>缺失数据小于50 %的标记有16K个，这足以估计254个株系的关系矩阵。因为我在一个符合UNIX的多处理器系统上运行这个代码，所以我可以使用12个核心来加速EM算法：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>rrBLUP<span class="punctuation">)</span> </span><br><span class="line">system.time<span class="punctuation">(</span>A1 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>X<span class="punctuation">,</span>impute.method<span class="operator">=</span><span class="string">&quot;EM&quot;</span><span class="punctuation">,</span>n.core<span class="operator">=</span><span class="number">12</span><span class="punctuation">,</span>max.missing<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>EM算法在执行过程中显示收敛序列，它表示关系系数的均方根误差。默认停止准则为0.02，但这可以随参数‘tol’( 输入 <code>?A.mat</code>获取更多信息 )而改变。在这种情况下，算法在达到0.0151时停止，只需不到一分钟。如果只有1个核心可用，只需省略n . core选项，默认情况下只使用1个核心。</p><p>用均值代替EM算法，语法是<code>system.time(A2 &lt;- A.mat(X,max.missing=0.5))</code>,用均值输入更快，而且在许多情况下，它似乎与EM算法和其他更复杂的GEBV精度方法一样。但是，与EM算法( 波兰等国 2012年 )相比，均值化后的育种值更容易出现偏差。对两个矩阵的平均对角元素的比较表明，在标记调用的杂合度约为1 %的情况下，EM算法的结果更接近期望1+f≈2：</p><h3 id="shrinkage-estimation-of-a"><a class="markdownIt-Anchor" href="#shrinkage-estimation-of-a"></a> Shrinkage estimation of A</h3><p><code>A.mat</code>的另一个独特之处是收缩估计，可以使用低密度标记，例如384SNP芯片。当行数与标记数相当或超过标记数时，方程1可能不是关系矩阵的最优估计。Endelman和Jannink ( 2012 )提议将估计缩小到( 1 + f ) I，收缩强度选择以最小化均方误差。</p><p>为了说明这一点，我将使用一套599个小麦品系，在BLR软件包(  Pérez等人 2010年 )的1279个DArT标记基因型：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>BLR<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>wheat<span class="punctuation">)</span></span><br><span class="line">M <span class="operator">&lt;-</span> 2<span class="operator">*</span>X<span class="operator">-</span><span class="number">1</span>  <span class="comment">#convert markers to &#123;-1,1&#125;</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>M<span class="punctuation">)</span></span><br><span class="line">A1 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">A2 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">[</span><span class="punctuation">,</span>sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">1279</span><span class="punctuation">,</span><span class="number">384</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">A3 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">[</span><span class="punctuation">,</span>sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">1279</span><span class="punctuation">,</span><span class="number">192</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GS </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>circos plot-1</title>
      <link href="/2021/11/01/circos-plot-1/"/>
      <url>/2021/11/01/circos-plot-1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="数据准备"><a class="markdownIt-Anchor" href="#数据准备"></a> 数据准备</h1><h2 id="1-文件格式"><a class="markdownIt-Anchor" href="#1-文件格式"></a> 1、文件格式</h2><ul><li>KARYOTYPE</li><li>线、散点图、直方图和热图</li><li>tile</li><li>text</li><li>links</li></ul><h4 id="karyotype染色体"><a class="markdownIt-Anchor" href="#karyotype染色体"></a> KARYOTYPE——染色体</h4><p>以水稻的karyotype文件为例，主要包括：名字、标签、起始和终止位置以及颜色</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">chr     -       Chr1    Chr1    0       43270923        Chr1</span><br><span class="line">chr     -       Chr2    Chr2    0       35937250        Chr2</span><br><span class="line">chr     -       Chr3    Chr3    0       36413819        Chr3</span><br><span class="line">chr     -       Chr4    Chr4    0       35502694        Chr4</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>可以在 <code>data/karyotype</code> 文件夹下找到常用的参考基因组的 <kbd>karyotype</kbd> 文件</p><h4 id="线-散点图-直方图和热图"><a class="markdownIt-Anchor" href="#线-散点图-直方图和热图"></a> 线、散点图、直方图和热图</h4><p>线、散点图、直方图和热图都是2D数据，具体格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#chrstartendvalue[options]</span><br><span class="line">Chr1    0       100000  0</span><br><span class="line">Chr1    100000  200000  0</span><br><span class="line">Chr1    200000  300000  0</span><br><span class="line">Chr1    300000  400000  0</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="tile"><a class="markdownIt-Anchor" href="#tile"></a> tile</h4><p><kbd>tile</kbd> 定义为同一染色体上的区间，用来显示覆盖率相关信息，如 <kbd>reads</kbd>或 <kbd>clones</kbd> 等信息,具体格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chr start end [options]</span></span><br><span class="line">Chr 0 100000 </span><br></pre></td></tr></table></figure><h4 id="text"><a class="markdownIt-Anchor" href="#text"></a> text</h4><p>与基因组位置相关的文本信息，如文本标签</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chr start end label [options]</span></span><br><span class="line">hs5 50 75 ABC</span><br></pre></td></tr></table></figure><p>如果你要显示多个词，可以用 <code>tab</code> 作为分隔符</p><h4 id="links"><a class="markdownIt-Anchor" href="#links"></a> links</h4><p>同一染色体或不同染色体不同区域之间的关系，可以绘制成线条或丝带的形状</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># chr1 start1 end1 chr2 start2 end2 [options]</span><br><span class="line">hs1 200 300 hs10 1100 1300</span><br><span class="line">hs7 50 150 hs 5000 6000 color=blue</span><br></pre></td></tr></table></figure><p><code>binlinks</code>, <code>bundlelinks</code> 和 <code>filterlinks</code> 工具 可以用于操作和分析 <code>link</code> 文件.</p><h2 id="2-options选项"><a class="markdownIt-Anchor" href="#2-options选项"></a> 2、options选项</h2><p>在<code>&lt;plot&gt;</code>, <code>&lt;link&gt;</code>,或 <code>&lt;highlight&gt;</code>块中定义的特定数据点的任何格式化选项，如形状、大小、颜色等，都通过输入文件来定义</p><p>在上面展示的例子中的 <code>[options]</code> 字符可以通过以逗号分隔的键值对的字符串来设置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end var1=value1,var2=value2,...</span><br></pre></td></tr></table></figure><p>而对于解析为列表值，如 <code>RGB</code> 值，需要用 <code>()</code>、<code>[]</code> 来分隔</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end color=(R,G,B)</span><br></pre></td></tr></table></figure><h5 id="有无数据值时的-options"><a class="markdownIt-Anchor" href="#有无数据值时的-options"></a> 有无数据值时的 options</h5><p>输入文件中有与基因组位置相关的值时，<code>options</code> 域在第 <code>5</code> 列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end value options</span><br></pre></td></tr></table></figure><p>如果没有值，<code>options</code> 域在第 <code>4</code> 列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end options</span><br></pre></td></tr></table></figure><h2 id="3-文件分隔符"><a class="markdownIt-Anchor" href="#3-文件分隔符"></a> 3、文件分隔符</h2><p>默认情况下是以空白符作为分隔符，想要更改分隔符,可以在配置文件中定义 <code>file_delim</code> 参数</p><p>最好是将参数放在 <code>etc/housekeeping.conf</code> 文件中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># etc/housekeeping.conf</span><br><span class="line">file_delim = \t</span><br></pre></td></tr></table></figure><p>如果想要设置多词文本标签，需要设置分隔符为 <code>tab</code>，将会应用于所有输入文件（数据文件和核型文件 <code>karyotype</code>）</p><h2 id="4-文件位置"><a class="markdownIt-Anchor" href="#4-文件位置"></a> 4、文件位置</h2><p>如果指定特定文件的绝对路径，<code>circos</code> 将不会去其他地方寻找文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file = /path/to/file.txt</span><br></pre></td></tr></table></figure><p>如果文件 <code>/path/to/file.txt</code> 不存在，将会引发错误</p><p>如果使用相对路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file = data/file.txt</span><br></pre></td></tr></table></figure><p><code>circos</code> 将会试图以下面的顺序在多个目录中查找</p><ul><li>在 <code>data_path</code> 下的所有目录</li><li><code>CWD/</code></li><li><code>CWD/etc</code></li><li><code>CWD/data</code></li><li><code>CWD/../</code></li><li><code>CWD/../etc</code></li><li><code>CWD/../data</code></li><li><code>CWD/../..</code></li><li><code>CWD/../../etc</code></li><li><code>CWD/../../data</code></li></ul><p><code>CWD</code> 为当前目录，推荐使用相对路径的方式，这样的可移植性较好</p><p>建议你将数据文件放置一个单独的文件夹中 <code>(e.g. data/)</code>，与配置文件区分开</p><hr /><p>本文参考了生信学习手册的内容，在此表示感谢，以下是原文链接<a href="https://mp.weixin.qq.com/s/Bj2bJKDevNMX3MbMO5TYPw">circos 学习手册</a></p>]]></content>
      
      
      <categories>
          
          <category> circos </category>
          
      </categories>
      
      
        <tags>
            
            <tag> circos </tag>
            
            <tag> rice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>circos 圈图</title>
      <link href="/2021/10/20/circos-%E5%9C%88%E5%9B%BE/"/>
      <url>/2021/10/20/circos-%E5%9C%88%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="环境配置"><a class="markdownIt-Anchor" href="#环境配置"></a> 环境配置</h2><p>建议在Linux环境下配置Circos，之后只要用conda就能配置好分析环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="comment">## circos</span></span><br><span class="line">conda create -c bioconda -n circos circos</span><br></pre></td></tr></table></figure><p>测试软件安装结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试circos</span></span><br><span class="line">conda activate circos</span><br><span class="line"><span class="comment"># 确认安装</span></span><br><span class="line">circos -V</span><br><span class="line"><span class="comment"># 显示如下</span></span><br><span class="line"><span class="comment"># circos | v 0.69-8 | 15 Jun 2019 | Perl 5.026002</span></span><br></pre></td></tr></table></figure><p>可以从http://circos.ca/software/download/下载官方的教程文件，分别是</p><ul><li><a href="http://circos.ca/distribution/circos-course-2017.tgz">circos-course-2017.tgz</a></li><li><a href="http://circos.ca/distribution/circos-tutorials-current.tgz">circos-tutorials-current.tgz</a></li></ul><h2 id="快速开始"><a class="markdownIt-Anchor" href="#快速开始"></a> 快速开始</h2><p>第一步，先新建一个文件夹，用于存放本次分析的所有数据和配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p my_first_circos &amp;&amp; <span class="built_in">cd</span> my_first_circos</span><br></pre></td></tr></table></figure><p>然后用<code>vim karyotype.tair10.txt</code>编辑文本，新增如下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr - chr1 chr1 0 30427617 black</span><br><span class="line">chr - chr2 chr2 0 19698289 black</span><br><span class="line">chr - chr3 chr3 0 23459830 black</span><br><span class="line">chr - chr4 chr4 0 18585056 black</span><br><span class="line">chr - chr5 chr5 0 26975502 black</span><br></pre></td></tr></table></figure><p>之后创建一个<code>circos.conf</code>文件，用于增加各类配置参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> circos.conf</span><br></pre></td></tr></table></figure><p>用<code>vim circos.conf</code>，增加我们的第一条记录，染色体信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">karyotype = karyotype.tair10.txt</span><br></pre></td></tr></table></figure><p>然而要想真正的出图，还需要增加至少以下配置语句才行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;ideogram&gt;</span><br><span class="line">&lt;spacing&gt;</span><br><span class="line">default = 0.005r</span><br><span class="line">&lt;/spacing&gt;</span><br><span class="line">radius           = 0.90r</span><br><span class="line">thickness        = 20p</span><br><span class="line">fill             = <span class="built_in">yes</span></span><br><span class="line">stroke_color     = dgrey</span><br><span class="line">stroke_thickness = 2p</span><br><span class="line">&lt;/ideogram&gt;</span><br><span class="line"></span><br><span class="line">&lt;image&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/image.conf&gt;&gt;</span></span><br><span class="line"><span class="string">&lt;/image&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;&lt;include</span> etc/colors_fonts_patterns.conf&gt;&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/housekeeping.conf&gt;&gt;</span></span><br></pre></td></tr></table></figure><p>在当前路径下运行<code>circos -conf circos.conf</code>, 最终效果图如下</p><p>虽然图比较丑，但是至少我们成功运行了人生第一次的circos, 这就相当于买了一套毛坯房，后面要做的事情就是不断装修。</p><p>比如说，我们至少可以让不同染色体拥有不同的颜色，修改之前的<code>karyotype.tair10.txt</code>中的最后一列</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr - chr1 chr1 0 30427617 chr1</span><br><span class="line">chr - chr2 chr2 0 19698289 chr2</span><br><span class="line">chr - chr3 chr3 0 23459830 chr3</span><br><span class="line">chr - chr4 chr4 0 18585056 chr4</span><br><span class="line">chr - chr5 chr5 0 26975502 chr5</span><br></pre></td></tr></table></figure><p>在当前路径下运行<code>circos -conf circos.conf</code>, 最终效果图如下</p><p>这就引出了第一个知识点，<strong>配色</strong>。</p><p>为了实现配色，需要<code>circos.conf</code>文件了有一个和配色有关的语句</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="string">include etc/colors_fonts_patterns.conf&gt;&gt;</span></span><br></pre></td></tr></table></figure><p>这里<code>&lt;&lt;&gt;&gt;</code>表示通过<strong>相对路径</strong>的方式加载另外一个配置文件，它的实际路径是和<code>circos</code>所在目录同级的<code>etc</code>,可用下面语句看到<code>colors_fonts_patterns.conf</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">circos_path=$(<span class="built_in">dirname</span> `<span class="built_in">which</span> circos`)</span><br><span class="line">less <span class="variable">$&#123;circos_path%bin&#125;</span>/etc/colors_fonts_patterns.conf</span><br></pre></td></tr></table></figure><p>你会发现，这个文件里还嵌套其他的配置文件。最终通过层层排查，你才知道<code>etc/colors.ucsc.conf</code>才是实际定义我们填写的颜色名的文件，而颜色的定义如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr1  = 153,102,0</span><br><span class="line">chr2  = 102,102,0</span><br><span class="line">chr3  = 153,153,30</span><br><span class="line">chr4  = 204,0,0</span><br><span class="line">chr5  = 255,0,0</span><br></pre></td></tr></table></figure><p>还有一个问题，为什么这里用的是两个尖括号<code>&lt;&lt;</code>，而不是一个尖括号<code>&lt;</code>呢？这是因为<code>&lt;</code>已经被用于分隔不同的语句块，如下语句就表示<code>etc/image.conf</code>里的配置信息是用来调整和<code>image</code>有关的配置，而不是去调整<code>ideogram</code>的配置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;image&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/image.conf&gt;&gt;</span></span><br><span class="line"><span class="string">&lt;/image&gt;</span></span><br></pre></td></tr></table></figure><hr /><p>以上是快速开始部分，后续将会在此基础上，做出发表级别的图。</p>]]></content>
      
      
      <categories>
          
          <category> 绘图 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> circos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>遗传分析中常见群体</title>
      <link href="/2021/10/18/%E9%81%97%E4%BC%A0%E5%88%86%E6%9E%90%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%BE%A4%E4%BD%93/"/>
      <url>/2021/10/18/%E9%81%97%E4%BC%A0%E5%88%86%E6%9E%90%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%BE%A4%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="遗传分析中常见群体"><a class="markdownIt-Anchor" href="#遗传分析中常见群体"></a> 遗传分析中常见群体</h1><p>群体是具有一些共同特征个体的集合。遗传学研究中提出的遗传交配设计有很多，根据情报的数量大致可以划分为双亲群体、多亲群体等。</p><blockquote><p>本文引用自<a href="http://blog.sciencenet.cn/home.php?mod=space&amp;uid=1094241&amp;do=blog&amp;id=1093008">科学网—扒一扒遗传分析中群体那些事儿 - 马省伟的博文 (sciencenet.cn)</a></p></blockquote><h3 id="双亲群体"><a class="markdownIt-Anchor" href="#双亲群体"></a> 双亲群体</h3><p>双亲衍生群体是自孟德尔杂交实验重新发现以来，植物遗传研究中使用最为广泛的群体类型。双亲杂交设计一般从两个具有明显表型差异的纯和基因型亲本（分别用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）开始，在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>间杂交产生<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代，并由此衍生出了常见的以下群体</p><ul><li>杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>群体及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mrow><mn>2</mn><mo>:</mo><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">F_{2:3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mrel mtight">:</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：由杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>自交产生，共显性标记（codominant marker）在群体内的分离比为1:2:1，显性标记（dominant marker）则为3:1</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>群体：杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代与亲本回交获得</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>I</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">RIL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">L</span></span></span></span>群体（重组自交系）：将F2群体不同个体连续自交或同胞交配，使家系内个体基因型趋于纯合，属于永久性定位群体；RIL群体的分离比率为1:1；单粒传法是常见的RIL群体创制方法，但需要多年多世代的工作。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>I</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">NIL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">L</span></span></span></span>群体（近等基因系群体）：群体内不同个体的染色体绝大部分区间完全相同，只有少数几个或一个区间彼此存在差异；NIL群体可以将多个QTL位点分解成单个孟德尔遗传因子，将数量性状转化为质量形状，从而可以对主效QTL进行精细定位和图位克隆。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">DH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span>群体：DH群体是配子基因型经染色体加倍形成的，不同个体基因型稳定，属于永久作图群体。该群体标记的分离比是1:1；该类型的群体不仅可以对质量性状进行定位，也可以对数量性状进行多年多点的重复实验，是研究基因型和环境互作的理想材料。</li></ul><h3 id="多亲群体"><a class="markdownIt-Anchor" href="#多亲群体"></a> 多亲群体</h3><p>顾名思义，多亲群体指的就是利用多亲本开展遗传交配设计，创建遗传群体并进行遗传研究，常见的有<strong>巢式关联作图群体</strong>（NAM，nested association mapping）和<strong>多亲本高代互交群体</strong>（MAGIC，multiparent advanced generation inter-crossing）。</p><ul><li><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>A</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">NAM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>群体：其实就是不同的亲本材料分别与同一材料（CP, commonparent）做杂交，再在杂交后代内部分别进行连续自交（单粒传法）或同胞交配以创制不同的一系列重组自交系（RIL）。这些重组自交系均含有一个相同亲本（CP），不同的重组自交系都是基于两个亲本所创制的。NAM群体结合了双亲群体和自然群体（natural population）的优点，可以用来做关联-连锁不平衡分析（joint linkage–linkage disequilibrium mapping）。第一个NAM群体是利用玉米自交系B73作为共有亲本分别与25份不同自交系杂交和自交而创建的，一共包括25个RIL群体和大约5000个株系。该群体已经被成功用于玉米开花时间或者抗叶枯病等方面的研究。</p></li><li><p><kbd>MAGIC</kbd>群体:由多个双亲进行两两进行杂交，来自于两个亲本的杂交<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代再分别两两杂交产生双交（double hybrids）后代，两个双交后代<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>再进一步杂交，这样产生的后代就分别来自与8个不同的亲本。这个杂交过程可以持续进行，以尽可能包含更多的亲本材料。最后这些复合杂交的后代经过自交或染色体加倍而形成一系列RIL群体或DH群体。MAGIC群体最早是在拟南芥（<em>Arabidopsis thaliana</em>）中创制的，大约来自于19个不同拟南芥材料相互交配的后代，一共包含527个重组自交系，该群体被用来进行拟南芥QTL性状的精细定位。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 遗传 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>how to start GO &amp; KEGG by clusterProfiler</title>
      <link href="/2021/10/09/how-to-start-GO-KEGG-by-clusterProfiler/"/>
      <url>/2021/10/09/how-to-start-GO-KEGG-by-clusterProfiler/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="1-go分析"><a class="markdownIt-Anchor" href="#1-go分析"></a> 1、GO分析</h3><h3 id="2-kegg分析"><a class="markdownIt-Anchor" href="#2-kegg分析"></a> 2、KEGG分析</h3><blockquote><p>Y叔的clusterProfiler可能是目前KEGG富集分析最好的软件，因为能爬取最新的KEGG在线版数据库，而不是用不再更新的KEGG.db。</p></blockquote><h4 id="enrichkegg-函数介绍"><a class="markdownIt-Anchor" href="#enrichkegg-函数介绍"></a> enrichKEGG 函数介绍：</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enrichKEGG<span class="punctuation">(</span>gene<span class="punctuation">,</span> organism <span class="operator">=</span> <span class="string">&quot;hsa&quot;</span><span class="punctuation">,</span> keyType <span class="operator">=</span> <span class="string">&quot;kegg&quot;</span><span class="punctuation">,</span> pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span>  </span><br><span class="line">        pAdjustMethod <span class="operator">=</span> <span class="string">&quot;BH&quot;</span><span class="punctuation">,</span> universe<span class="punctuation">,</span> minGSSize <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> maxGSSize <span class="operator">=</span> <span class="number">500</span><span class="punctuation">,</span>  </span><br><span class="line">        qvalueCutoff <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> use_internal_data <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gene：基因名，需与keyType对应</span></span><br><span class="line"><span class="comment"># organism：从http://www.genome.jp/kegg/catalog/org_list.html获取</span></span><br><span class="line"><span class="comment"># keyType:基因命名方式，包括：kegg、ncbi-geneid、ncbi-proteinid 和uniprot</span></span><br></pre></td></tr></table></figure><h4 id="分析思路"><a class="markdownIt-Anchor" href="#分析思路"></a> 分析思路</h4><h5 id="organism"><a class="markdownIt-Anchor" href="#organism"></a> organism</h5><p>首先确定自己要研究的物种，在这里我们研究对象是水稻。所以打开<a href="https://www.genome.jp/kegg/catalog/org_list.html">KEGG Organisms: Complete Genomes</a>，搜索Oryza sativa</p><p><img src="image-20211009163706228.png" alt="" /></p><p>上图左边的osa和dosa就是要填到organism里的参数，选择其中一个就行，这里推荐<kbd>dosa</kbd></p><h5 id="keytypes"><a class="markdownIt-Anchor" href="#keytypes"></a> keyTypes</h5><p>可以把enrichKEGG当作浏览器，试出合适的keytypes。</p><p><img src="image-20211009215233046.png" alt="" /></p><p>因此，我们需要提供的keyType是<code>kegg</code>，基因名应该类似于<code>Os06t0664200-01</code>.</p><blockquote><p>按照同样的套路，对于<code>osa</code>的kegg命名方式应该<code>3131385</code>能够用于在NCBI上查找的gene ID。</p></blockquote><h5 id="基因id转换"><a class="markdownIt-Anchor" href="#基因id转换"></a> 基因ID转换</h5><p>通常情况下，我们获取的基因ID往往是<kbd>LOC_Os01g24710</kbd>或<kbd>Os01g0348900<br /></kbd>的形式，那么应该怎么转换为<kbd>Os01g0348900-01</kbd>呢？<br />首先去相关数据库https://shigen.nig.ac.jp/rice/oryzabase/ 下载id文件，通过一行命令完成转换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> salt.txt | xargs -i awk <span class="string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125;  $0 ~/&#123;&#125;/ &#123; print $2&#125;&#x27;</span> rice_id_20140620174522.txt &gt; RAP_id.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GO </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GO </tag>
            
            <tag> KEGG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件按列合并及调整列的顺序</title>
      <link href="/2021/08/17/%E6%96%87%E4%BB%B6%E6%8C%89%E5%88%97%E5%90%88%E5%B9%B6%E5%8F%8A%E8%B0%83%E6%95%B4%E5%88%97%E7%9A%84%E9%A1%BA%E5%BA%8F/"/>
      <url>/2021/08/17/%E6%96%87%E4%BB%B6%E6%8C%89%E5%88%97%E5%90%88%E5%B9%B6%E5%8F%8A%E8%B0%83%E6%95%B4%E5%88%97%E7%9A%84%E9%A1%BA%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="按列合并文件"><a class="markdownIt-Anchor" href="#按列合并文件"></a> 按列合并文件</h3><p>paste</p><blockquote><p>语法： paste file1 file2</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file1.txt</span></span><br><span class="line"></span><br><span class="line">a   1</span><br><span class="line">b   1</span><br><span class="line">c   3</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file2.txt</span></span><br><span class="line"></span><br><span class="line">a   4</span><br><span class="line">b   5</span><br><span class="line">c   6</span><br></pre></td></tr></table></figure><p>合并：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">paste</span> file1 file2 &gt; file3.txt</span></span><br><span class="line">cat file3.txt</span><br><span class="line">a   1   a   4</span><br><span class="line">b   1   b   5</span><br><span class="line">c   3   c   6</span><br></pre></td></tr></table></figure><p>默认的分割符是制表符，也可以指定其他分隔符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">paste  -d &#x27;_&#x27; file1.txt file2.txt</span><br><span class="line">a   1_a   4</span><br><span class="line">b   1_b   5</span><br><span class="line">c   3_c   6</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="调整列的顺序"><a class="markdownIt-Anchor" href="#调整列的顺序"></a> 调整列的顺序</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27; &#123; t = $1; $1 = $2; $2 = t; print; &#125; &#x27; input_file</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="去除m"><a class="markdownIt-Anchor" href="#去除m"></a> 去除^M</h3><p>首先查看文件有没有<kbd>^M</kbd>,<code>cat -v filename</code>,如果有可以采用以下几种方式</p><ul><li>dos_2unix</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dos2unix /fileth/name</span><br></pre></td></tr></table></figure><ul><li>sed</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sed --in-place=&#x27;&#x27; &#x27;s./^M//g&#x27; /path/to/file</span><br></pre></td></tr></table></figure><h3 id="修改文件的间隔符"><a class="markdownIt-Anchor" href="#修改文件的间隔符"></a> 修改文件的间隔符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sampleID.txt|tr &quot;\t&quot; &quot;,&quot; &gt; sampleID_form.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> awk paste </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客的编辑</title>
      <link href="/2021/08/17/%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%BC%96%E8%BE%91/"/>
      <url>/2021/08/17/%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%BC%96%E8%BE%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="博客的创建"><a class="markdownIt-Anchor" href="#博客的创建"></a> 博客的创建</h2><blockquote><p>hexo 语法</p></blockquote><p>创建文章前要先选定模板，在hexo中也叫做布局。hexo支持三种布局（layout）：post(默认)、draft、page。<br />首先进入博客的主目录,执行以下命令<code>hexo n &quot;my first blog&quot;</code>,会默认使用post布局，然后自动在source_posts目录生成一个my first blog.md文件：</p><p>当然此时可以指定布局: <code>hexo n [layout_name] draft1</code>,此时你就在创建你的一篇草稿.<br />如果此时你想要插入图片,可以使用如下的语法<code>![](image.jpg)</code></p><p><img src="%E6%8A%AC%E5%A4%B4.png" alt="" /></p><p>如果插入视频,</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=39807850&cid=69927212&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div><p>当编辑完成之后，就可以把文章推送到_posts目录下：<code>hexo publish &lt;file_name&gt;</code></p><h3 id="常用命令"><a class="markdownIt-Anchor" href="#常用命令"></a> 常用命令</h3><ul><li><strong>清除缓存：</strong><code>hexo clean</code></li><li><strong>生成静态文件：</strong><code>hexo generate</code>可简写为 <code>hexo g</code></li><li><strong>启动服务器：</strong><code>hexo server</code>或者 <code>hexo s</code> 常用参数：<code>-p（--port）</code>重设端口</li><li><strong>部署：</strong><code>hexo deploy</code>可简写为<code>hexo d</code>，用于将网站部署到服务器上。（暂时用不到，目前都是在本地，后面我们将博客托管到<code>GitHub Pages</code>或<code>Gitee Pages</code>时才会用到此命令）<br />常用参数：<code>-g（--generate）</code>，<code>hexo d -g</code>部署前预先生成静态文件，等同于 <code>hexo g -d</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
