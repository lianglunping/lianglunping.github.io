<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>绘制单倍型热图</title>
      <link href="/2023/04/04/%E7%BB%98%E5%88%B6%E5%8D%95%E5%80%8D%E5%9E%8B%E7%83%AD%E5%9B%BE/"/>
      <url>/2023/04/04/%E7%BB%98%E5%88%B6%E5%8D%95%E5%80%8D%E5%9E%8B%E7%83%AD%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>绘制如下热图<br /><img src="hap-pheatmap.png" alt="" /></p><h2 id="工作目录"><a class="markdownIt-Anchor" href="#工作目录"></a> 工作目录</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Users/lianglunping/Library/CloudStorage/OneDrive-个人/xiaowai/ZYY/</span><br></pre></td></tr></table></figure><h2 id="文件准备"><a class="markdownIt-Anchor" href="#文件准备"></a> 文件准备</h2><h4 id="分组文件"><a class="markdownIt-Anchor" href="#分组文件"></a> 分组文件</h4><p><code>ZYY.list</code>,内容如下：1-3列分别是：样本ID、K9分组、K5分组</p><p><img src="image-20230404102224992.png" alt="" /></p><h4 id="基因型文件"><a class="markdownIt-Anchor" href="#基因型文件"></a> 基因型文件</h4><p><code>gene1.haplo.txt</code>,内容如下：</p><p><img src="image-20230404102410220.png" alt="" /></p><h2 id="运行代码"><a class="markdownIt-Anchor" href="#运行代码"></a> 运行代码</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 环境准备</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line">require<span class="punctuation">(</span>reshape<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>bruceR<span class="punctuation">)</span></span><br><span class="line">set.wd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取分组信息</span></span><br><span class="line">row_groups<span class="operator">=</span>read.table<span class="punctuation">(</span><span class="string">&quot;gene1/ZYY.list&quot;</span><span class="punctuation">,</span>head <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>row_groups<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;ID&quot;</span><span class="punctuation">,</span><span class="string">&quot;K9&quot;</span><span class="punctuation">,</span><span class="string">&quot;K5&quot;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>row_groups<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取基因型信息</span></span><br><span class="line">data<span class="operator">=</span>read.table<span class="punctuation">(</span><span class="string">&quot;gene1/gene1.haplo.txt&quot;</span><span class="punctuation">,</span>head <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对基因型信息进行预处理</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> data <span class="operator">%&gt;%</span> filter<span class="punctuation">(</span>FID <span class="operator">!=</span> <span class="string">&quot;313-8921&quot;</span><span class="punctuation">)</span> <span class="comment">#去除分组为na的样本</span></span><br><span class="line">d <span class="operator">&lt;-</span> data<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>row_groups<span class="punctuation">,</span>data1<span class="punctuation">)</span></span><br><span class="line">data2<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">data2 <span class="operator">&lt;-</span> arrange<span class="punctuation">(</span>data2<span class="punctuation">,</span>K5<span class="punctuation">)</span></span><br><span class="line">table<span class="punctuation">(</span>data2<span class="operator">$</span>K5<span class="punctuation">)</span></span><br><span class="line">data2<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">data3<span class="operator">&lt;-</span>data2<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">data3<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">rownames<span class="punctuation">(</span>data3<span class="punctuation">)</span><span class="operator">&lt;-</span>data2<span class="operator">$</span>ID</span><br><span class="line">data3<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">data4 <span class="operator">&lt;-</span> t<span class="punctuation">(</span>data3<span class="punctuation">)</span></span><br><span class="line">data4<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备绘图参数</span></span><br><span class="line">row_groups1 <span class="operator">&lt;-</span> arrange<span class="punctuation">(</span>row_groups<span class="punctuation">,</span>K5<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>row_groups1<span class="punctuation">)</span></span><br><span class="line">row_groups2 <span class="operator">&lt;-</span> row_groups1<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment">#row_groups2 &lt;- row_groups[,2]</span></span><br><span class="line">mat_row <span class="operator">&lt;-</span> data.frame <span class="punctuation">(</span>group <span class="operator">=</span> row_groups2<span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>mat_row<span class="punctuation">)</span> <span class="operator">&lt;-</span> row.names<span class="punctuation">(</span>data3<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>mat_row<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="string">&quot;K5&quot;</span></span><br><span class="line">head<span class="punctuation">(</span>mat_row<span class="punctuation">)</span></span><br><span class="line">mat_colors <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">   K5 <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>ADM <span class="operator">=</span> <span class="string">&quot;#c49af7&quot;</span><span class="punctuation">,</span>Aus <span class="operator">=</span> <span class="string">&quot;#f19d9b&quot;</span><span class="punctuation">,</span>Bas<span class="operator">=</span><span class="string">&quot;#5d813f&quot;</span><span class="punctuation">,</span>GJ<span class="operator">=</span><span class="string">&quot;#f0ccaf&quot;</span><span class="punctuation">,</span> XI<span class="operator">=</span><span class="string">&quot;#c2d6ec&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="comment"># K9 = c(Admix = &quot;#a7a7a7&quot;, Aus=&quot;#fea200&quot;,Bas=&quot;#9a32fc&quot;,</span></span><br><span class="line">  <span class="comment">#        GJ_adm = &quot;#adabfa&quot;, GJ_sbtrp=&quot;#2342bd&quot;,GJ_tmp=&quot;#81cdfa&quot;,</span></span><br><span class="line">  <span class="comment">#        GJ_trp = &quot;#5aabef&quot;, XI_1A=&quot;#009c0b&quot;,XI_1B=&quot;#61b9a7&quot;,</span></span><br><span class="line">  <span class="comment">#        XI_2 =  &quot;#2d5234&quot;,XI_3=&quot;#75a90b&quot;,XI_adm=&quot;#9eb89c&quot;)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>data3<span class="punctuation">,</span> </span><br><span class="line">         <span class="comment"># color = c(  &quot;#fecfe4&quot;,&quot;#fdf6eb&quot;,&quot;#81b2d9&quot;,&quot;#cdecc6&quot;) ,</span></span><br><span class="line">         color <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>  <span class="string">&quot;#cbcbcb&quot;</span><span class="punctuation">,</span><span class="string">&quot;#f8da78&quot;</span><span class="punctuation">,</span><span class="string">&quot;#cadfb9&quot;</span><span class="punctuation">,</span><span class="string">&quot;#e0ebf5&quot;</span><span class="punctuation">)</span> <span class="punctuation">,</span></span><br><span class="line">         show_colnames<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span> </span><br><span class="line">         show_rownames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> </span><br><span class="line">         legend_breaks <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">,</span> </span><br><span class="line">         legend_labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;./.&quot;</span><span class="punctuation">,</span> <span class="string">&quot;0/0&quot;</span><span class="punctuation">,</span> <span class="string">&quot;0/1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">         cluster_row <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> </span><br><span class="line">         cluster_cols <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">         annotation_row    <span class="operator">=</span> mat_row<span class="punctuation">,</span></span><br><span class="line">         annotation_colors <span class="operator">=</span> mat_colors<span class="punctuation">,</span></span><br><span class="line">         annotation_legend <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">         main<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> plot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hap </tag>
            
            <tag> pheatmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>群体结构分析可视化</title>
      <link href="/2023/04/04/%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
      <url>/2023/04/04/%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90%E5%8F%AF%E8%A7%86%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>基于Q矩阵绘制群体结构图，代码如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#install devtools package from CRAN</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;devtools&#x27;</span><span class="punctuation">,</span>dependencies<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>devtools<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#install pophelper package from GitHub</span></span><br><span class="line">install_github<span class="punctuation">(</span><span class="string">&#x27;royfrancis/pophelper&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#load library for use</span></span><br><span class="line">library<span class="punctuation">(</span>pophelper<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>bruceR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">set.wd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># import Q matrix</span></span><br><span class="line">files <span class="operator">&lt;-</span> paste0<span class="punctuation">(</span><span class="string">&quot;test.&quot;</span><span class="punctuation">,</span><span class="number">2</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span><span class="string">&quot;.Q&quot;</span><span class="punctuation">)</span></span><br><span class="line">myslist1 <span class="operator">&lt;-</span> readQ<span class="punctuation">(</span>files <span class="operator">=</span> files<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># import ID info </span></span><br><span class="line">ID <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;ZYY.list&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>ID<span class="punctuation">)</span><span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;id&quot;</span><span class="punctuation">,</span><span class="string">&quot;K9&quot;</span><span class="punctuation">,</span><span class="string">&quot;K5&quot;</span><span class="punctuation">)</span></span><br><span class="line">myonelabset<span class="operator">=</span>as.data.frame<span class="punctuation">(</span>ID<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>myonelabset<span class="punctuation">)</span><span class="operator">=</span><span class="string">&quot;k5&quot;</span></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>myslist1<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">row.names<span class="punctuation">(</span>myslist1<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&lt;-</span> ID<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">c1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#d3e1f1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#b2a7d2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#d16d69&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#ecb576&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#253761&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#b0d094&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plotQ<span class="punctuation">(</span>myslist1<span class="punctuation">,</span> </span><br><span class="line">      imgoutput <span class="operator">=</span> <span class="string">&quot;join&quot;</span><span class="punctuation">,</span></span><br><span class="line">      showindlab <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> <span class="comment">#是否在每个面板下展示标签</span></span><br><span class="line">      grplab <span class="operator">=</span> myonelabset<span class="punctuation">,</span></span><br><span class="line">      barsize <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      selgrp <span class="operator">=</span> <span class="string">&quot;k5&quot;</span><span class="punctuation">,</span></span><br><span class="line">      ordergrp<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>  <span class="comment">#是否按标签排序</span></span><br><span class="line">      showtitle <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">      titlelab <span class="operator">=</span> <span class="string">&quot;Population Structure&quot;</span><span class="punctuation">,</span></span><br><span class="line">      titlecol <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">      useindlab <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> <span class="comment"># 是否使用数据集自带标签</span></span><br><span class="line">      indlabhjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> </span><br><span class="line">      indlabangle <span class="operator">=</span> <span class="number">90</span><span class="punctuation">,</span> <span class="comment">#angle of labels</span></span><br><span class="line">      indlabsize <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> <span class="comment">#size of labels</span></span><br><span class="line">      sortind <span class="operator">=</span> <span class="string">&quot;all&quot;</span><span class="punctuation">,</span></span><br><span class="line">      sharedindlab <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> <span class="comment">#</span></span><br><span class="line">      <span class="comment"># clustercol=clist$shiny,</span></span><br><span class="line">      clustercol<span class="operator">=</span>c1<span class="punctuation">,</span></span><br><span class="line">      splabsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> <span class="comment"># K值字体的大小</span></span><br><span class="line">      grplabsize <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> <span class="comment"># 分群字体大小</span></span><br><span class="line">      panelspacer <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> </span><br><span class="line">      indlabspacer <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span></span><br><span class="line">      indlabcol <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">      titlehjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>showsp <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">      sppos <span class="operator">=</span> <span class="string">&quot;left&quot;</span><span class="punctuation">,</span>splab <span class="operator">=</span> paste0<span class="punctuation">(</span><span class="string">&quot;K=&quot;</span><span class="punctuation">,</span><span class="number">2</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      imgtype <span class="operator">=</span> <span class="string">&quot;pdf&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">24</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">#splabangle = 180,dpi = 1200,</span></span><br><span class="line">      splabangle <span class="operator">=</span> <span class="number">180</span><span class="punctuation">,</span>dpi <span class="operator">=</span> <span class="number">700</span><span class="punctuation">,</span></span><br><span class="line">      outputfilename <span class="operator">=</span> paste0<span class="punctuation">(</span><span class="string">&quot;admixture_barplot2&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      units <span class="operator">=</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">,</span>exportpath<span class="operator">=</span>getwd<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      exportplot <span class="operator">=</span> <span class="built_in">T</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>最终成图如下：</p><p><img src="admixture_barplot2.png" alt="" /></p>]]></content>
      
      
      <categories>
          
          <category> plot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> admixture </tag>
            
            <tag> pophelper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基因组预测——水稻改良的进展与前景</title>
      <link href="/2023/02/02/%E5%9F%BA%E5%9B%A0%E7%BB%84%E9%A2%84%E6%B5%8B%E2%80%94%E2%80%94%E6%B0%B4%E7%A8%BB%E6%94%B9%E8%89%AF%E7%9A%84%E8%BF%9B%E5%B1%95%E4%B8%8E%E5%89%8D%E6%99%AF/"/>
      <url>/2023/02/02/%E5%9F%BA%E5%9B%A0%E7%BB%84%E9%A2%84%E6%B5%8B%E2%80%94%E2%80%94%E6%B0%B4%E7%A8%BB%E6%94%B9%E8%89%AF%E7%9A%84%E8%BF%9B%E5%B1%95%E4%B8%8E%E5%89%8D%E6%99%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="2022-irri综述基因组预测水稻改良的进展与前景-bioinfarmer"><a class="markdownIt-Anchor" href="#2022-irri综述基因组预测水稻改良的进展与前景-bioinfarmer"></a> 【2022-IRRI综述】基因组预测：水稻改良的进展与前景 - Bioinfarmer</h1><p>[TOC]</p><p>目前水稻、小麦和玉米等作物GS应用主要在两个有代表性的国际组织开展，一是国际玉米小麦改良中心（CIMMYT），二是国际水稻所（IRRI），这两个都是国际农业研究协商小组（CGIAR）下属16个国际农业研究中心之一。本文（<a href="https://link.springer.com/protocol/10.1007/978-1-0716-2205-6_21#Sec25">Genomic Prediction: Progress and Perspectives for Rice Improvement</a>）作为IRRI今年（2022年）发表在Springer出版社Methods in Molecular Biology的其中一个章节，介绍了他们在水稻GS应用（该文主要针对自交系应用，杂交稻应用康奈尔大学的Jennifer Spindel/Susan Mccouch有讨论过）上的总结与展望。与其他学术研究不同的是，他们特别强调了GS在育种计划中的实施，并分享了他们的做法，非常具有实践意义。</p><h2 id="摘要"><a class="markdownIt-Anchor" href="#摘要"></a> 摘要</h2><p>基因组预测可以是一个强大的工具，如果彻底地整合到一个育种策略中，可以实现更高的数量性状的遗传增益率。在水稻和其他作物中，人们对基因组预测的兴趣非常浓厚，有许多研究涉及其使用的多个方面，从概念性的到实践性的都有。在本章中，我们回顾了有关水稻（Oryza sativa）的文献，并总结了在育种计划中整合基因组预测的重要考虑。国际水稻研究所的灌溉育种项目被用作一个具体的例子，我们提供数据和R脚本来重现分析，但也强调了有关预测使用的实际挑战。俗话说：“对有锤子的人来说，一切都像钉子”，这句话描述了一个常见的心理陷阱，它有时会困扰一个学科的新技术的整合和应用。我们设计这一章是为了帮助水稻育种者避免这种陷阱，并理解应用基因组预测的好处和局限性，因为它并不总是最好的方法，也不是在任何情况下提高遗传增益率的第一步。</p><h2 id="1-引言"><a class="markdownIt-Anchor" href="#1-引言"></a> 1 引言</h2><p>植物育种可以被认为是一种数字游戏，育种计划的目的是利用有限的资源增加找到具有理想特征组合的基因型的概率。育种方案是捕捉育种者在一个育种周期内所有活动的概念框架。一个育种周期可以概括为四个主要部分：创造、评估、选择和重组，旨在创造新的变异，准确评估育种种质的性能，并将选定的个体重新组合，形成改良群。评估是育种计划的核心部分，它涉及多个表型步骤，旨在估计选择对象的可遗传价值（或育种价值）。就产量而言，通常在多环境试验（MET）中评估一组针对高遗传性状预选的基因型，旨在代表产品预期表现的目标环境群体（TPE）。在大多数植物育种项目中，评估过程的这些最后步骤需要大量的资源并跨越多年。为了克服这一局限性并提高育种项目的效率，在过去的三十年中出现了一些方法和工具，这在很大程度上是由于DNA多态性和计算能力的提高。其中，利用分子信息推断表型性能的方法（如标记辅助选择和基因组选择）是重要的工具，使现代育种计划能够最大限度地利用其有限的资源。与经典的标记辅助选择相反，基因组预测考虑了大效应和小效应的数量性状位点，从而捕捉到了一个性状的更高比例的遗传变异。</p><p>基因组选择的概念是由Meuwissen等人首次为动物育种提出的。在这项模拟研究中，作者根据没有表型记录的幼年动物的分子标记来预测遗传价值，使用前两代的动物来估计标记效应。他们获得了预测育种值（基因组估计育种值-GEBV）的高精确度，并得出结论，这种提高遗传增益率的方法与缩短世代间隔的技术相结合，具有潜力。基因组选择通常是指根据其GEBV（基因组预测）来选择候选者的过程，这些候选者只有基因分型。为了达到这个目的，首先用训练集（一个较小的代表个体集，它尽可能地反映了用于预测的个体的遗传学）对标记-表型关系进行建模，表型和全基因组标记数据都是在该训练集上产生的。为了评估模型的性能，大多数情况下，预测值和观察值之间的相关性是通过验证群体来计算的，验证群体的组成取决于验证策略。<strong>该指标通常被称为准确性或预测能力，取决于预测与哪种观察值相比较：育种值比较用准确性，表型比较用预测能力</strong>。</p><p>2010年代，中高密度基因分型技术的加速发展导致了第一份关于基因组预测在奶牛中实际应用的报告，随后从事农业上重要植物物种的育种者也做出了重要贡献。事实上，基因组预测现在是一个激烈的研究领域，寻求优化其使用并整合到全球的植物和动物育种计划中。我们对影响GEBVs准确性的主要因素的理解已经取得了重要进展，包括育种计划的有效种群规模、目标性状的遗传性和遗传结构、训练种群的规模和组成，以及标记的数量、分布和信息性。基因组预测模型及其在软件工具中的实施也受到了特别关注，以便有效地利用不仅包含在基因组和表型数据集中的所有信息，而且还包含在其他 &quot;全能 &quot;数据源中的信息。虽然人们对预测准确性的驱动因素越来越了解，但如何将基因组预测最好地整合到现有的植物育种策略中，仍然是一个挑战，因为育种计划是在各种各样的背景下运作的（目标性状、物种、资源、规模等）。</p><p>水稻（Oryza sativa）是分子生物学的典范物种，也是人类大部分地区的主食。由于绿色革命期间和紧随其后的育种工作，生产力得到了重要的提高。这些改进主要是通过大型分离系谱苗圃的表型选择实现的。分子标记的使用也是引进生物或非生物胁迫的主要等位基因的关键。这一策略的成功在很大程度上取决于所选择的性状（株高、成熟度、抗病性、粒型）的高遗传率和简单的遗传结构，以及O. sativa和密切相关的物种如O. glaberrima（非洲水稻）、O. rufipogon或O. nivara的非常大和特征明确的遗传多样性。这可以解释为什么相对于动物育种或传统的异花授粉作物（如玉米）的育种，全球水稻育种界对实施基因组预测的兴趣被推迟了。在此期间，值得一提的是，在拉丁美洲，通过循环选择策略进行群体改良，取得了一些关键性进展。然而，最近，其他物种产量遗传增益的加速，基因分型成本的降低，以及水稻生产中可持续性的日益重要，促使人们对在水稻育种中部署基因组预测的兴趣增加。</p><p>在本章中，我们首先概述了水稻基因组预测的研究，重点是在育种计划中使用该策略的研究。然后我们强调将基因组预测纳入水稻育种计划的重要考虑因素。在第二部分中，我们介绍了诸如确定育种计划中基因组选择的切入点、训练群体的有效设计、缩短世代间隔的策略以及数据管理系统的重要性等方面。在第三部分，我们以国际水稻研究所（IRRI）的灌溉系统育种计划为例，介绍了将基因组预测纳入产品开发计划的情况，并提供了相关数据和R脚本来运行和解释分析结果（可在数据1、2和3中找到）。在最后一部分，我们介绍了基因组预测的有趣进展，这些进展可以进一步帮助水稻育种项目提高其效率。我们本章的目的是为水稻育种者提供一个坚实的基础，使他们了解在育种策略中使用基因组预测的优势和局限性，以最大限度地提高相关性状的遗传增益率。由于近交系水稻在亚洲的大量存在，我们选择将<strong>本章的范围集中在自交系亚洲水稻</strong>（O. sativa）上，尽管对杂交水稻应用基因组预测的特殊性讨论较少。关于基因组预测对水稻育种的重要性的另一个观点，我们请读者参考Spindel和Iwata和Ahmadi等人的书中章节。</p><h2 id="2-水稻的基因组预测工作"><a class="markdownIt-Anchor" href="#2-水稻的基因组预测工作"></a> 2 水稻的基因组预测工作</h2><p>关于作物物种的基因组预测的文献非常丰富。2014年以来发表了50多项研究（表1），水稻的基因组预测也不例外。我们报告了大多数在水稻上发表的研究（专门的或与其他物种一起发表的），以强调迄今为止所进行的工作的数量和多样性，以及它们与改进育种策略的相关性。为了实现后者，我们有意强调以与育种计划相结合为重点的研究，这些研究倾向于报告实施过程中更实际的挑战。<br />表1 关于水稻的基因组预测的研究。</p><table><thead><tr><th>References</th><th>Population</th><th></th><th>Number of</th><th></th><th>Prediction models</th><th>Accuracy</th></tr></thead><tbody><tr><td></td><td>Type</td><td>Size</td><td>Traits</td><td>Markers</td><td></td><td></td></tr><tr><td>Guo et al.</td><td>Diversity panel</td><td>413</td><td>30</td><td>36,901</td><td>GBLUP</td><td>0.21–0.84</td></tr><tr><td>Xu et al.</td><td>Hybrids</td><td>278–105</td><td>4</td><td>1,619</td><td>GBLUP , LASSO, SSVS</td><td>0–0.69</td></tr><tr><td>Zhang et al.</td><td>Diversity panel</td><td>413</td><td>11</td><td>36,901</td><td>GBLUP , BayesB, BLUP|GA</td><td>0.51–0.85</td></tr><tr><td>Akdemir et al.</td><td>Diversity panel</td><td>413</td><td>6</td><td>36,901</td><td>RR-BLUP</td><td>0.2–0.8</td></tr><tr><td>Blondel et al.</td><td>Diversity panel</td><td>335</td><td>14</td><td>1,311</td><td>RF, Ordinal McRank, RankSVM, GBRT, RKHS RR, LambdaMART, B-LASSO EB-LASSO, MIX, SSVS, BayesC, wBSR</td><td>0.68–0.72</td></tr><tr><td>Grenier et al.</td><td>Synthetic breeding population</td><td>343</td><td>4</td><td>8,336</td><td>B-LASSO, B-RR, GBLUP, RR-BLUP, LASSO</td><td>0.12–0.54</td></tr><tr><td>Isidro et al.</td><td>Diversity panel</td><td>413</td><td>4</td><td>36,901</td><td>RR-BLUP</td><td>0.22–0.73</td></tr><tr><td>Iwata et al.</td><td>Two diversity panels</td><td>179–386</td><td>1</td><td>3,254–36,901</td><td>GBLUP , RKHS, PLSR, KPLSR</td><td>0.4–0.64</td></tr><tr><td>Onogi et al.</td><td>Cultivars</td><td>110 –</td><td>8</td><td>3,102</td><td>GBLUP , RKHS, LASSO, Elastic net, RF, B-LASSO, EB-LASSO, BSR</td><td>0.40–0.84a</td></tr><tr><td>Spindel et al.</td><td>Breeding lines</td><td>332</td><td>3</td><td>73,147</td><td>RR-BLUP, B-LASSO, RKHS, RF, MLR, PBLUP</td><td>0–0.63a</td></tr><tr><td>Bustos-Korts et al.</td><td>Diversity panel</td><td>413</td><td>3</td><td>26,259</td><td>GBLUP , QGBLUP, RKHS</td><td>0.28–0.81</td></tr><tr><td>Jacquin et al.</td><td>Breeding lines and diversity panel</td><td>230, 167 and 188</td><td>15</td><td>22,691- 16,444- 38,390</td><td>LASSO, GBLUP, SVM, RKHS</td><td>0.12–0.70</td></tr><tr><td>Onogi et al.</td><td>Mapping population</td><td>174</td><td>1</td><td>162</td><td>EB-LASSO, EB-LASSO + crop model</td><td>0.87–0.97</td></tr><tr><td>Spindel et al.</td><td>Breeding lines</td><td>332</td><td>3</td><td>58,318</td><td>GBLUP , RR-BLUP, B-LASSO, RKHS, RF, MLR</td><td>0–0.65a</td></tr><tr><td>Campbell et al.</td><td>Diversity panel</td><td>360</td><td>1</td><td>36,901</td><td>GBLUP</td><td>0.39–0.73</td></tr><tr><td>Gao et al.</td><td>Breeding lines</td><td>315</td><td>3</td><td>58,227</td><td>GBLUP (10 relationship matrices)</td><td>0.24–0.57</td></tr><tr><td>Matias et al.</td><td>Breeding lines</td><td>270</td><td>2</td><td>39,915</td><td>B-RR, BayesB, B-LASSO</td><td>0.26–0.42</td></tr><tr><td>Morais et al.</td><td>Synthetic breeding population</td><td>174</td><td>8</td><td>6174</td><td>GBLUP (5 relationship matrices)</td><td>0.31–0.68</td></tr><tr><td>Wang et al.</td><td>Hybrids</td><td>575</td><td>8</td><td>3,299,150</td><td>GBLUP (univariate and multivariate)</td><td>0.40–0.86</td></tr><tr><td>Xu et al.</td><td>Hybrids</td><td>1495</td><td>10</td><td>1,654,030</td><td>GBLUP</td><td>0.40–0.88</td></tr><tr><td>Ben Hassen et al.</td><td>Diversity panel Breeding lines</td><td>284 and 97</td><td>3</td><td>43,686</td><td>GBLUP , RKHS (univariate and multivariate)</td><td>−0.12 to 0.96</td></tr><tr><td>Ben Hassen et al.</td><td>Diversity panel Breeding lines</td><td>284 and 97</td><td>3</td><td>43,686</td><td>GBLUP , RKHS, BayesB</td><td>0.23–0.65</td></tr><tr><td>Campbell et al.</td><td>Diversity panel</td><td>357</td><td>1</td><td>33,674</td><td>GBLUP</td><td>0.4–0.89</td></tr><tr><td>Du et al.</td><td>Mapping population</td><td>210</td><td>4, 1000, 24,973</td><td>1,619</td><td>RR-BLUP, PCR, PLSR</td><td>0.12–0.76</td></tr><tr><td>Gao et al.</td><td>Breeding lines</td><td>315</td><td>3</td><td>58,227</td><td>GBLUP (7 relationship matrices)</td><td>0.24–0.56</td></tr><tr><td>Mathew et al.</td><td>Diversity panel</td><td>371</td><td>1</td><td>36,901</td><td>GBLUP (multivariate)</td><td>0.49–0.77</td></tr><tr><td>Monteverde et al.</td><td>Breeding lines</td><td>309 and 327</td><td>5</td><td>44,598 92,430</td><td>GBLUP , RHKS (multivariate)</td><td>0.30–0.88</td></tr><tr><td>Morais Júnior et al.</td><td>Synthetic breeding population</td><td>174</td><td>8</td><td>6174</td><td>ABLUP, GBLUP, AGBLUP HBLUP, BayesC, B-LASSO, PLSR, RF, RKHS</td><td>0.23–0.76</td></tr><tr><td>Morais Júnior et al.</td><td>Synthetic breeding population</td><td>667 and 174</td><td>3</td><td>6174</td><td>Bayesian HBLUP (multivariate with environmental covariates)</td><td>−0.15 to 0.9</td></tr><tr><td>Xu et al.</td><td>Hybrids</td><td>575</td><td>8</td><td>2,561,889</td><td>GBLUP , PLSR, LASSO, BayesB, SVM, RKHS</td><td>0.15–0.88</td></tr><tr><td>Yabe et al.</td><td>Cultivars</td><td>123</td><td>1</td><td>42,508</td><td>GBLUP , PLSR</td><td>0.22–0.53</td></tr><tr><td>Arbelaez et al.</td><td>Breeding lines</td><td>353</td><td>3</td><td>965</td><td>ABLUP, RR-BLUP, BayesA, BayesB, BayesC, B-LASSO, RKHS</td><td>0.36–0.71</td></tr><tr><td>Azodi et al.</td><td>Breeding lines</td><td>327</td><td>3</td><td>73,147</td><td>RR-BLUP, B-RR, BayesA, BayesB, B-LASSO, SVM, RF, GTB, ANN, CNN</td><td>0.25–0.65</td></tr><tr><td>Berro et al.</td><td>Breeding lines</td><td>317 and 327</td><td>1</td><td>44,598 92,430</td><td>GBLUP</td><td>0.37–0.80</td></tr><tr><td>Bhandari et al.</td><td>Diversity panel</td><td>280</td><td>3</td><td>215,242</td><td>GBLUP , RKHS</td><td>0.23–0.81</td></tr><tr><td>E Sousa et al.</td><td>Breeding lines</td><td>270</td><td>2</td><td>39,811</td><td>GBLUP , RKHS</td><td>0.18–0.31</td></tr><tr><td>Frouin et al.</td><td>Diversity panel Breeding lines</td><td>228 and 95</td><td>2</td><td>22,370</td><td>GBLUP , BayesA, RKHS</td><td>0.23–0.54</td></tr><tr><td>Guo et al.</td><td>Hybrids</td><td>1439</td><td>4</td><td>1,654,030</td><td>GBLUP</td><td>0.59–0.77a</td></tr><tr><td>Hu et al.</td><td>Mapping population</td><td>210</td><td>4, 1000, 24,973</td><td>1,619</td><td>Multilayered-LASSO</td><td>0.16–0.76</td></tr><tr><td>Huang et al.</td><td>Diversity panel</td><td>161 and 162</td><td>1</td><td>66,109 29,030</td><td>RR-BLUP, GBLUP (multivariate), BayesA, BayesC</td><td>0.15–0.80</td></tr><tr><td>Lima et al.</td><td>Diversity panel</td><td>370</td><td>7</td><td>36,901</td><td>GBLUP , Delta-p</td><td>0.27–0.83</td></tr><tr><td>Monteverde et al.</td><td>Breeding lines</td><td>309–327</td><td>4</td><td>44,598 92,430</td><td>GBLUP , PLSR (multivariate environmental covariates)</td><td>0.10–0.90a</td></tr><tr><td>Ou et al.</td><td>Diversity panel</td><td>404</td><td>10</td><td>30,315</td><td>RR-BLUP</td><td>0.09–0.78a</td></tr><tr><td>Suela et al.</td><td>Diversity panel</td><td>352</td><td>9</td><td>36,901</td><td>Delta-p, GBLUP, BayesC, B-LASSO</td><td>0.10–0.83</td></tr><tr><td>Wang et al.</td><td>Hybrids, mapping population</td><td>210 and 278</td><td>4, 1000, 24,973</td><td>1,619</td><td>LASSO, GBLUP, SVM, PLSR</td><td>0.1–0.70a</td></tr><tr><td>Wang et al.</td><td>Hybrids</td><td>575</td><td>8</td><td>61,836</td><td>GBLUP</td><td>0.07–0.15</td></tr><tr><td>Baba et al.</td><td>Diversity panel</td><td>357</td><td>2</td><td>34,993</td><td>Random regression (univariate and multivariate)</td><td>0.17–0.91a</td></tr><tr><td>Banerjee et al.</td><td>Breeding lines</td><td>315</td><td>3</td><td>73,147</td><td>RR, LASSO, SVM, Bagging, RF, AdaBoost, XGBoost</td><td>0.10–0.67</td></tr><tr><td>Cui et al.</td><td>Hybrids</td><td>1495 and 100</td><td>10 6</td><td>102,795</td><td>GBLUP (multivariate)</td><td>0.35–0.92</td></tr><tr><td>Grinberg et al.</td><td>Diversity panel</td><td>2265</td><td>12</td><td>101,595</td><td>LASSO, RR, GBLUP, GBM, RF, SVM</td><td>0.14–0.70</td></tr><tr><td>Jarquin et al.</td><td>Cultivars</td><td>112</td><td>1</td><td>408,372</td><td>GBLUP</td><td>0.41–0.93</td></tr><tr><td>Schrauf et al.</td><td>Diversity panel</td><td>2018</td><td>1</td><td>4,000,000</td><td>GBLUP (3 relationship matrices)</td><td>0.16–0.83a</td></tr><tr><td>Toda et al.</td><td>Mapping population</td><td>123</td><td>1</td><td>315</td><td>GBLUP , LASSO, RR, RKHS, RF (integration with crop model)</td><td>0.40–0.68a</td></tr><tr><td>Xu et al.</td><td>Hybrids, mapping population</td><td>210 and 278</td><td>4, 1000, 24,973</td><td>1,619</td><td>GBLUP (different relationship matrices)</td><td>0.20–0.80a</td></tr></tbody></table><h3 id="21-总体概述"><a class="markdownIt-Anchor" href="#21-总体概述"></a> 2.1 总体概述</h3><p>第一批报告使用水稻基因组预测的研究是在2014年发表的（表1）。尽管水稻有丰富的基因组和标记资源，但这些研究竟然是在玉米、小麦或大麦的第一个基因组预测研究（使用真实数据）发表后5年进行的。迄今为止，水稻可用的基因组资源的广度和已被表征的遗传多样性的深度，导致发现了许多具有合理效应大小的主要QTL。尽管对水稻育种界来说，这是一种独特而宝贵的资源，但对外来种质的大效应QTL的发现、表征和引进的高度重视，可能会推迟向基因组预测的过渡。这些早期的水稻基因组预测研究中评估的种群类型倾向于加强这种印象（图1a）。事实上，在2014年发表的前三项研究中，有两项是基于相同的多样性panel，一项是基于从作图群体（永生F2）衍生的杂交种。总的来说，在许多情况下，为关联研究而设计的多样性panel在迄今发表的研究中占很大比例（图1a）。对于这些研究中的大多数，其目的是方法学上的：了解种群结构的影响，整合关于性状遗传结构的现有知识，训练集优化，模型比较或整合作物模型而不直接影响育种计划。鉴于水稻的祖先亚种群结构的程度，使用多样性panel来评估基因组预测模型可能会引起预测能力估计的偏差。<strong>事实上，如果不考虑种群结构，大部分的预测能力可能来自于亚种群之间的预测能力，而不是亚种群内部的预测能力</strong>。除基于多样性panel的研究外，16项研究使用了育种系，9项研究侧重于杂交种，6项研究使用了定位群体，4项研究基于合成群体，3项研究使用了栽培品种（图1a）。</p><p><img src="Fig1" alt="Fig1" /></p><blockquote><p>图1 关于水稻基因组预测的文献摘要。它代表了表1中详细的信息。(a) 用于训练基因组预测模型的种群类型的树状图，以及基于已发表数据集的研究的相关参考文献。(b) 数据集的重要特征直方图：种群的大小、表型性状的数量、测量性状的环境数量（年份、季节或地点），以及用于基因组预测的分子标记数量。© 54项研究中使用最多的10个预测模型的圆圈图。(d) 用于评估预测模型准确性的验证策略的圆图：交叉验证（CV）、HAT方法、组内验证和后代验证。</p></blockquote><p>除了在这些研究中遇到的各种各样的种群外，种群的规模、标记的数量、表型的数量或用于描述种群特征的环境的数量也有很大差异（图1b）。最大的种群规模（2265）是利用3000水稻基因组计划的公开数据实现的。鉴于收集高质量表型数据的局限性和困难，可以理解的是大多数研究采用了300左右的种群规模（表1）。在使用1000或2000个个体的大群体的情况下，表型是在非常有限的环境中进行的（通常是1或2个）。事实上，不到一半的研究使用了三个以上的环境进行表型评价（图1b）。在有10个或更多环境（年份、季节或地点）表型信息的三项研究中，有两项是基于育种计划的种质，但数据集是不平衡的（并非所有个体在所有环境中都有表型或基因分型）。第三项研究来自Jarquin等人，使用来自51个环境的信息，结合日长来预测未经测试的基因型的发芽天数。在考虑的各种性状中，开花期（或成熟期）、株高和谷物产量是最常见的。标记的数量从162个到400万个不等，大多数的研究使用几千个标记（表1）。通过测序和固定SNP芯片的基因分型是最常用的技术。在某些情况下，通过一般低覆盖率（1×或2×）的全基因组再测序，然后进行填充，可以获得非常高的标记密度。</p><p>基因组预测的统计方法是许多研究的核心，在所有的物种中都得到了应用。在54项水稻研究中，评估了33种不同的方法，其中基因组最佳线性无偏预测（GBLUP）方法使用最多（图1c）。自该方法提出以来，其灵活性和稳健性使其迅速成为动物和植物育种的参考方法。与传统的系谱BLUP类似，GBLUP使用一个基于标记的加性关系矩阵，而不是系谱信息。这种加性模型的一些扩展或变体已被提出，以说明显性和/或上位性，或使用其他 多组学数据（转录组或代谢组）来估计个体间的相关度。除GBLUP外，RKHS（再生核希尔伯特空间）、贝叶斯LASSO（最小绝对收缩和选择算子）、RR-BLUP（岭回归BLUP）、RF（随机森林）、SVM（支持向量机）、PLSR（偏最小二乘回归）、BayesB和BayesC是这些水稻研究中使用最多的方法（图 1c）。来自机器学习的其他方法，如梯度提升机（GBM）或人工神经网络（ANN），也在基因组预测方面进行了评估，结果不一。</p><p>验证集的组成在决定预测的准确性方面可以发挥重要作用，它在很大程度上取决于每个研究中使用的验证策略（上表删除，见原文）。Sallam等人根据训练集和验证集的组成，定义了三种主要的验证方法：交叉验证（子集验证）、interset验证和progeny（后代）验证。交叉验证或子集验证（k-fold、留一、随机或分层抽样）是迄今为止我们总结的所有研究中使用最多的策略（图1d）。这种验证方法非常方便，因为你只需要将数据划分为训练集和验证集，就可以在没有 &quot;独立 &quot;数据集的情况下估计准确度（如需要进行interset或progeny验证）。由于其性质，与更现实的验证场景相比，交叉验证往往会高估预测的准确性。当使用多变量模型时，情况变得更加复杂。另一种接近交叉验证的方法，即HAT方法，在四项研究中被使用。这种方法以随机效应的hat矩阵为基础，使用预测的残差平方之和来估计预测的准确性，在GBLUP 、RKHS和贝叶斯模型的背景下工作。这种方法比交叉验证法要快得多，因为不需要额外的模型再训练。interset和progeny验证方法只在三项研究中分别使用（图1d）。考虑到育种计划的背景，基因组预测的整合主要是为了减少周期时间，后代验证代表了对预测模型性能的更有意义的评估。事实上，在基因组选择的最初概念中，Meuwissen等人使用了progeny验证：用1001代和1002代的数据建立模型，用预测值和1003代的真实育种值计算准确率。此外，由于后代中的重组，标记和QTL之间发生的连锁不平衡的衰减往往会降低预测的准确性，但在应用于实际育种的情况下，使其更具有现实的可解释性。例如，Ben Hassen等人用有限的个体数量对近交系进行后代验证，发现对相同性状的预测能力比交叉验证低。</p><h3 id="22-水稻基因组预测的重要发现和目前的局限性"><a class="markdownIt-Anchor" href="#22-水稻基因组预测的重要发现和目前的局限性"></a> 2.2 水稻基因组预测的重要发现和目前的局限性</h3><h4 id="221-重要的研究结果"><a class="markdownIt-Anchor" href="#221-重要的研究结果"></a> 2.2.1 重要的研究结果</h4><p>表1提供了本综述中每项研究的主要目标的简短摘要。因此，读者可以被引导到与它问题最相关的出版物。此后，我们总结了重要的结果，主要集中在那些与育种计划的实施最相关的结果。</p><ol><li><strong>基因组预测在不同情况下的作用</strong>。所有研究中最重要的结果是，基于分子标记的性能预测是有效的。事实上，GEBVs的准确性相对较高，即使是像粮食产量这样的性状。许多水稻育种者关注基因组预测的效率，但从有关水稻的文献来看，更确切地说，使用育种种质的研究，显然是没有道理的。</li><li>**预测精度可以提高。**育种者可以发挥不同的因素来提高预测的准确性或减少实施的成本。事实上，通过优化训练集的组成和评估，通过瞄准信息丰富的分子标记（具有中、高最小等位基因频率的多态性并沿基因组分布），或通过整合额外的数据（历史、环境协变量、作物模型…），可以获得更好的准确性。训练集的大小和组成决定了与选择对象的遗传关系的强度，这是驱动准确性的最重要因素之一。因此，已经开发了选择训练集的算法。关于分子标记，不同的研究表明，<strong>标记密度在一定程度上可以减少而不影响预测的准确性</strong>。例如，Arbelaez等人设计了一种具有成本效益的SNP检测方法，只选择了1000个在精英育种材料中具有信息量的标记，并获得了良好的准确性。</li><li><strong>模型可以预测子代的表现</strong>。基因组选择的最初概念是基于对子代育种价值的预测，目的是减少育种周期的时间。对水稻进行后代验证的极少数研究表明，当使用父母本的信息来预测后代的表现时，会有很好的结果。然而，在这个方向上还有更多的工作要做，因为与基因组预测整合有关的遗传增益的增加大多与育种周期时间的减少有关。</li><li>**基因组预测在杂交的情况下是有效的。**有关标记密度、训练集识别和模型选择的许多经验同样适用于杂交种和自交系育种计划。杂交种计划确实提出了独特的挑战，可以应用不适用于其他育种计划的预测。值得注意的是预测如何将雄性和雌性结合起来以创造优良的杂交组合。在杂交水稻中，有一些证据表明，杂交性能是由来自雄性和雌性品系的加性遗传学的累加所驱动。将非加性参数纳入预测似乎没有什么帮助。虽然这似乎是合理的，但其他作物也显示出杂交性能有明显的非加性成分（如在玉米中）。这个特殊的结论可能是由于遗传基础非常狭窄，对谷物产量的组内预测精度非常低而产生的偏差。也有证据表明，多性状模型可以提高杂交水稻低遗传率性状的预测精度。这在杂交水稻中特别重要，因为许多性状（特别是商品成本性状，如杂交种子产量）在育种计划的早期特别难以测量。与杂交计划相关的一组特别独特的相关表型是有机会测量自交系亲本的本身表现以及同一材料的杂交表现。使用亲本表型数据与杂交种性能的数据相结合，可以将杂交水稻产量的预测精度提高约13%。</li><li><strong>建立GxE模型可以提高预测的准确性</strong>。无论是通过多环境基因组预测模型，还是通过结合作物生长模型和基因组预测模型，一些研究证明了这些方法在预测环境特异性能方面有更好的准确性。在多环境模型的情况下，与传统的表型选择相比，基因组选择的一个关键优势是模型能够评估标记效应和标记效应与环境的相互作用，并最终提高预测精度。随着作物生长模型在基因组预测框架中的整合，基因型对环境变化的反应被模拟出来，从而可以预测候选品种在未测试环境中的表现。这种方法对水稻改良非常有希望，因为它更好地考虑了GxE。然而，在育种计划中常规使用作物生长模型需要在数据采集和分析方面进行大量的投资，因此对于容易受到环境限制的特定水稻系统来说将是很有意义的。</li><li><strong>基因组预测模型之间的差异是很小的</strong>。大多数比较基因组预测的统计模型的研究发现，它们之间在准确性方面的差异很小或没有差异。一般来说，没有一个模型对所有的性状或验证方法都是持续较好的。GBLUP由于其简单性、包括不同类型信息的通用性和对不同性状结构的稳健性，通常被用作参考。贝叶斯模型（如B-LASSO、BayesB或BayesC）或RKHS在处理受大效应基因影响的性状（如开花期或抗稻瘟病）时表现更好。少数使用机器学习方法（如ANN或SVM）的研究报告了令人失望的结果，即使对参数进行了优化，性能也很不稳定。可能需要在这个方向上做进一步的工作，以得出这些方法对常规基因组预测的兴趣。</li></ol><h4 id="222-目前的局限性"><a class="markdownIt-Anchor" href="#222-目前的局限性"></a> 2.2.2 目前的局限性</h4><p>尽管研究的数量和多样性，但在有关水稻的文献中仍有一些问题没有被很好地涉及。根据不同的情况，它们可能会对充分利用基因组选择的潜力造成限制。</p><ol><li><strong>仅有准确度不足以评估基因组预测的有效性</strong>。几乎所有的研究都是根据预测的准确性来评价基因组选择的。尽管准确度是评估预测模型效率的一个重要因素，但它并不能告知哪些个体被不同的方法所选择。realized selection differential （实现的选择差异？？）可能是比较不同基因组预测方法的一个更好的指标，因为育种家会共同考虑几个性状来优化材料，这使得对性状的单独评估变得不那么相关。最后，正如Bassi等人正确指出的那样，表型也只是真实育种值的一个预测因子，并且和GEBV一样有一个误差方差。</li><li><strong>没有充分考虑家系内预测的准确性</strong>。没有关于水稻的研究使用多个双亲家庭或父母信息作为训练集，详细研究了家庭内预测的准确性。事实上，除了使用一个双亲家族的研究这一特殊情况外，关于家族内准确性的报告很少。这在杂交文献中也很明显，大多数论文集中在预测特定的杂交组合上，而没有试图估计新的雄性或雌性群体的一般结合能力。然而，当涉及到实施基因组预测时，这是一个关键点，因为更高的家族内准确性有助于提高遗传增益率，同时平衡种群中的近亲繁殖水平。由于家族内和家族间的变化都被模型捕捉到，所以杂交之间的差异可以得到更好的预测。</li><li><strong>谷粒品质或抗病性状被忽略了</strong>。迄今为止，没有发表与抛光谷物的营养价值（锌含量、血糖指数…）有关的研究。只有一项研究评估了基因组预测的潜力，以帮助利用育种降低谷物中的砷含量。关于抗病性，Huang等人的唯一研究报告称，预测对几种木兰花菌（瘟疫）分离株的抗性的准确率为0.15至0.72。对于抗病性，水稻遗传学家主要关注主要基因，但针对定量变异也很重要，以解决绕过抗病性等问题。对于谷物的营养价值，利用多性状基因组预测可以更好地解决性状之间的负相关。</li><li>**在育种计划中的实施是次要的。**虽然很明显，所有研究的基本目标是提高我们对基因组预测的认识，以优化育种策略，但很少有研究将其发现放在育种计划的具体案例中。例如，Spindel等人建议将基因组预测整合到灌溉水稻育种管道中，并讨论了这种方案的优势和限制。然而，对于大多数从事育种种质的研究（见表1），情况并非如此。因此，这些结果仍然是理论多于实践，因为这种分析对于证明在基因组选择方面的投资和了解其实施的潜在障碍非常重要。</li></ol><h2 id="3-将基因组预测纳入水稻育种计划关键点"><a class="markdownIt-Anchor" href="#3-将基因组预测纳入水稻育种计划关键点"></a> 3 将基因组预测纳入水稻育种计划：关键点</h2><p>水稻育种计划中基因组选择的切入点会因计划的目标、现有的育种策略、育种者必须考虑的遗传和/或环境限制、以及基因分型和选择中的性状的成本而不同。然而，在整合一个育种计划实施基因组预测的准备工作之前，有一些关键的先决条件需要评估。如果缺乏必要的组成部分，如（a）明确的目标，（b）细致的数据管理，（c）有效的操作，（d）有效的表型和（e）基于BLUP的选择，基因组预测的应用是非常有限的。使用育种数据或专门设计的训练集执行基因组预测，对于建立做预测的基线能力是有用的，但将该技术整合到现有的育种计划中可能是一个挑战。育种计划代表着多年的流水线，管理着重叠的种质群，所以改变策略往往是逐步进行的，以免扰乱产品开发的过程。本节的目的是就在水稻育种计划中实施基因组选择策略前需要考虑的重要因素提供指导。</p><h3 id="31-绘制育种策略图"><a class="markdownIt-Anchor" href="#31-绘制育种策略图"></a> 3.1 绘制育种策略图</h3><p>基因组预测的主要价值在于其在决策中的使用，以便在育种计划的一个或几个阶段有效地选择育种材料。因此，对育种策略及其不同组成部分的清楚了解是有效整合基因组预测的基础。通常情况下，育种方案存在于育种家的头脑中，将这种知识转化为结构化的框架是精心设计替代方案的一个强制性步骤。基因组预测是育种方案的长期投资，直接过渡到最佳基因组选择策略并不总是可能的。因此，需要由育种团队和专家详细制定过渡计划，以确定实现目标的明确步骤。在有关基因组预测的文献中通常没有这方面的报道，因为这涉及到有关育种计划的更多技术信息。在水稻方面，只有一项研究将结果置于育种计划的框架内，并详细介绍了基因组预测的使用及其潜在影响<a href="https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004982">Jennifer Spindel et al. PLOS Genetics, 2015</a>。然而，正如在小麦中所显示的那样，育种方案的这一步骤对于整合或优化基于过去几年中所获得的知识的基因组选择至关重要。</p><p>最佳的基因组选择方案通常不是当前育种方案的简单演变。水稻和一般自花授粉作物的大多数常规育种方案都依赖于系谱育种，但基因组选择最适合于基于优良杂交的轮回选择方案，以改善复杂的性状。事实上，一个结构良好的育种计划，其优良种质已被明确鉴定，且有效种群规模较小（Ne≈40），由于标记和QTL之间的连锁不平衡度较高，种群结构较低或没有，以及基因型之间的关联度较高，更有可能从使用基因组预测中受益。此外，要充分利用基因组预测，还需要几个重大变化：减少周期时间，建立训练集，存储/使用表型和基因型数据，重新分配预算和人员。了解这些变化之间的相互联系，以及它们将如何影响当前的操作顺序，可以预见潜在的障碍。</p><p>关键建议：</p><ul><li>明确界定当前的育种战略及其目标。</li><li>将基因组预测的整合作为一项长期投资进行规划，并有明确的路线图。</li><li>在优良种群中使用轮回选择，最大限度地发挥基因组预测的潜力。</li></ul><h3 id="32-减少周期"><a class="markdownIt-Anchor" href="#32-减少周期"></a> 3.2 减少周期</h3><p>基因组选择的一个有趣方面是，它使植物育种界更加关注育种的基本原理。育种家方程中捕捉到的对选择的反应的概念也许是最好的例子。在该方程的参数中，世代间隔（或周期）是最容易理解和操作的。正如Meuwissen等人在其开创性的论文中所强调的，使用基因组预测可以通过减少周期时间来大大增加遗传增益率。结论是，根据标记物预测的遗传值进行选择可以大大增加动物和植物的遗传增益率，特别是如果与繁殖技术相结合，缩短世代间隔。这一结论在15年后被第一份关于基因组选择对奶牛遗传增益率影响的报告所证实。作者发现，世代间隔的急剧缩短与产量性状的遗传增益率的急剧增加有关（50-100%）。在植物育种中，缩短周期的方法（独立于使用基因组选择）已经研究了几十年 。尽管最近提出了更多的现代方法，但在农作物物种中，快速世代进展（RGA）或双倍单倍体可能是最常见的 。在水稻中，RGA最近重新引起了人们的兴趣，因为它是快速固定材料（通常在1年内从F2到F6）的一种具有成本效益的方法，可以在重复试验中进行评估。这可以在温室、屏风房或田间实现，取决于可用的资源。对于从事经典系谱育种计划的育种家来说，使用RGA可以作为实施基因组选择的第一步。对于已经实施RGA或类似方法来缩短周期的育种计划，基因组选择可以进一步帮助缩短育种周期。然而，这需要一个能有效预测下一代（后代）遗传价值的基因组预测模型。因此，在实施这种类型的计划之前，必须构成一个基于一个或几个以前周期的材料的训练集。基于轮回选择的更积极的策略也是如此，其目的是重新组合仅根据预测值选择的非固定材料（S0）。在这种方案中，种群改良部分与产品开发部分部分脱钩，允许1年甚至更短的育种周期。目前，只有模拟研究报告了这种类型的方案，因为在实施之前必须解决若干技术挑战。事实上，育种周期时间的急剧减少可能导致过渡期内不同周期之间的重叠活动，可能会扰乱正在进行的周期或大幅增加工作量。</p><p>主要建议：</p><ul><li>将基因组预测与稳定的方法结合起来，产生自交系（如快速加代），以有效减少周期时间。</li><li>在基因组预测路线图中考虑到与缩短周期相关的技术限制因素。</li></ul><h3 id="33-设计训练集"><a class="markdownIt-Anchor" href="#33-设计训练集"></a> 3.3 设计训练集</h3><p>一旦确定了育种计划中基因组预测的切入点，训练集的设计就是实施基因组选择的第一步。关于训练集必须做出三个主要的选择：组成大小、表型和基因分型。育种家必须在这三个方面找到一个平衡点，以便根据可用资源优化训练集。大多数育种项目开始的一个简单方法是开始对进入产量试验的每个品系进行基因分型。从那里，这些数据集可以根据经验进行优化，以提高预测的准确性。</p><p>众所周知，准确性随着训练集的大小而增加。理论和经验研究表明，在处理复杂性状时，训练集的大小应最大化。然而，主要由于基因分型和表型的成本，大型训练集并不总是可行的。为了实现高准确度，同时将规模保持在可管理的范围内，开发了几种优化训练集组成的方法。所有这些方法都使用加性遗传关系（通常基于标记数据）来对一组有代表性的基因型进行优化采样。训练集优化的一个关键方面是对预测集（候选群）的定义。事实上，训练集和候选群体之间的密切遗传关系是最大限度地提高预测准确性的关键。因此，大多数优化方法都是共同考虑构成训练集和预测集的基因型，以直接计算基于关联性的标准（训练集和预测集之间关系系数的平均值）或估计基于混合模型理论的标准（预测误差方差、决定系数或预期精度）。在训练集和预测集来自同一种群（例如，来自同一队列的候选群）或预测个体的信息尚未获得（例如，后代）的情况下，已经开发出优化方法，以最小化训练集个体之间的遗传关系。根据数据的可用性和预测目标，育种者可以在这些优化方法中选择塑造训练集，并在需要预测新周期的候选群时更新训练集。</p><p>训练集组成的优化必须与表型分析策略结合起来进行。在大多数情况下，将用于更新预测模型的候选品种在MET中被评估为关键性状，以估计G×E。由于可用于评估的地块总数几乎是固定的，育种家需要平衡群体大小和重复水平（在环境内和环境间）。通常情况下，在育种周期中重复水平会增加，以便在最后阶段将更多的资源用于少数更有希望的品系。在基因组选择的背景下，评价单位是等位基因而不是个体，在减少重复水平的同时增加训练集的大小，往往会提高预测的准确性。因此，在经典的完全重复的实验中，典型的训练群体规模（150-300）的表型可以乘以1.5-3的稀疏测试。然而，最好在环境内和环境间有足够水平的重复，以便：（1）保持重复性，特别是对低遗传率性状；（2）评估G×E的水平；（3）避免重复太少的模型收敛问题。当种子供应受到限制时，使用稀疏测试方法对重复的限制也可以是一个好机会。</p><p>最后，需要仔细考虑用于对训练和预测集进行基因分型的技术，以便有效地捕获不同的QTL等位基因以及群体中的一般亲缘关系。在选择或开发适当的基因分型技术时，有几个因素起作用：成本、标记的类型、密度、目标群体的信息量、可重复性率等。在应用基因组预测的情况下，对育种计划所管理的遗传多样性进行良好的定性，对于确定达到最佳预测精度所需的标记密度至关重要。用确定性和随机性模拟表明，当有效种群数量增加时，标记密度必须增加以保持准确性。然而，大多数水稻的实证研究发现，对于有效种群规模低于50的育种项目，当标记密度超过每厘摩根2-5个标记时，准确性达到了一个高峰。</p><p>主要建议：</p><ul><li>在可能的情况下，最大限度地提高训练集和预测集之间的关联性。</li><li>使用稀疏的表型测试，以平衡训练集的大小和可用资源的水平。</li><li>避免使用一个育种流水线的训练集来预测另一个育种流水线的候选群。</li></ul><h3 id="34-生成和整合高质量的数据"><a class="markdownIt-Anchor" href="#34-生成和整合高质量的数据"></a> 3.4 生成和整合高质量的数据</h3><p>正如前面所强调的，数据采集和管理是育种计划的重要组成部分。所有的推进决策都是基于来自多个来源（田间、实验室、服务提供者等）的记录数据。从种子到表型和/或基因型的仔细数据管理必须到位以确保准确性。使用数字数据收集工具是尽可能减少数据收集过程中可能出现的错误的一个关键方法。令人担忧的是，已经用模拟数据证明，即使是表型记录中很小比例的严重错误（0.1%或1%）也会严重降低对选择的反应。当系谱记录中存在错误时，也发现类似的结论。除了准确的数据，还需要强大的和适当设计的分析管道来策划数据并将其转化为可解释的信息。与传统的标记辅助选择相比，基因组预测增加了一层复杂性，因为它可能需要整合几年来收集的不同类型的数据（表型、基因型、系谱和/或天气数据）才能发挥作用。数据类型和格式的一致性以及数据结构的长期稳定性是充分利用历史育种数据的力量来训练和持续更新基因组预测模型的关键环节。</p><p>为了帮助育种者进行数据管理，不同的公共组织都有软件解决方案，如育种管理系统Breeding Management System（<a href="https://bmspro.io/">https://bmspro.io</a>）、Breeding4Results（B4R）（<a href="https://riceinfo.atlassian.net/wiki/spaces/ABOUT/pages/326172737/Breeding4Results+B4R%EF%BC%89%E3%80%81Breedbase%EF%BC%88">https://riceinfo.atlassian.net/wiki/spaces/ABOUT/pages/326172737/Breeding4Results+B4R）、Breedbase（</a><a href="https://breedbase.org/">https://breedbase.org</a>），或GOBii基因组数据管理（<a href="https://gobiiproject.atlassian.net/wiki/spaces/GD/overview%EF%BC%89%E3%80%82%E5%B0%BD%E7%AE%A1%E5%9C%A8%E5%BC%80%E5%8F%91%E5%88%86%E6%9E%90%E7%AE%A1%E9%81%93%EF%BC%88%E5%A6%82RiceGalaxy%EF%BC%8C">https://gobiiproject.atlassian.net/wiki/spaces/GD/overview）。尽管在开发分析管道（如RiceGalaxy，</a><a href="https://galaxy.irri.org/">https://galaxy.irri.org</a>）和旨在实现植物育种数据库之间互操作性的育种API项目（<a href="https://brapi.org/">https://brapi.org</a>）方面做出了重大努力，但在应用育种计划的背景下，没有有效的端到端解决方案可供执行基因组预测的公开。事实上，在现有的实施基因组预测的软件中存在一些限制，包括缺乏基因型和表型数据之间的直接联系，有限的多环境或多性状分析能力，没有可能将显性或上位性效应纳入预测模型，以及没有将天气数据有意义地纳入分析管道。因此，大多数公共育种项目从他们各自的数据管理软件中提取表型和基因型数据，并使用特别的分析管道来运行基因组预测模型。希望像育种API或企业育种系统（<a href="https://ebs.excellenceinbreeding.org/">https://ebs.excellenceinbreeding.org</a>）这样的项目能在不久的将来在一个旨在实现应用育种项目的连贯框架内提供这些可能性。</p><p>关键建议：</p><ul><li>尽可能地使用数字数据收集系统。</li><li>与数据管理系统和高效的基因组预测分析程序合作（GBLUP , RR-BLUP）。</li><li>多年来使用一致的基因型和表型数据结构，以促进数据整合。</li></ul><h3 id="35-考虑到成本问题"><a class="markdownIt-Anchor" href="#35-考虑到成本问题"></a> 3.5 考虑到成本问题</h3><p>将基因组选择纳入育种计划是一项长期投资，必须转化为更好的遗传增益率才值得实施。即使使用基因组选择的优势很明显，但相对于遗传、操作和成本限制，最佳的育种方案也不容易确定。在确定了什么是最优的目标后，需要以预算友好的方式转换为这种新策略，这可能是加强现代育种计划的最重要限制。然而，有几个杠杆可以用来解放旨在全面部署基因组选择的计划中的资源。</p><p>第一个杠杆与表型有关。由于有了基因组预测，一些表型分析的步骤可以减少甚至取消，节省了相关的费用。事实上，这是基因组预测的主要优势之一，如果有合适的数据结构，就可以减少周期时间和表型成本。在计划整合基因组预测时，应仔细评估表型分析的成本和用预测取代表型分析活动的可能性，因为有时可能需要修改育种方案。这方面的一个关键例子是在从传统的纯种育种计划过渡时产生的成本节约，在传统的纯种育种计划中，固定步骤（F2-F5）中发生的选择可以推迟到自交系提取之后，用更便宜和更快的基于SSD的RGA方法代替基于田间的纯种圃。在这个层面上节省的成本可以很容易地覆盖基因分型的成本，因为通过RGA推进材料的成本要低得多（每个F5/F6系大约1美元）。但是，各组织必须考虑多年的预算战略，以适应如果不能利用现有的温室设施进行这项活动可能产生的固定成本。最初的资本投资通常可以通过几年内减少的运营成本来支付。此外，各组织必须考虑到由于伴随着育种周期的缩短和选择精度的提高，遗传收益的增加而可能产生的额外资金。</p><p>另一个收回成本的直接方法是通过使用基因组预测来减少昂贵的表型分析工作的数量。这可以通过选择性地对试验中精心选择的子集进行表型分析，以获得昂贵的性状，如谷物生物化学或其他收获后的性状，并利用节省的成本来支付DNA指纹的费用。此外，开发一个高通量相关性状的指数，与目标性状相比，其测量成本可能较低或提供更高的通量，可以降低表型的成本并提供类似的准确性。在这种情况下，多性状基因组预测提供了一个理想的框架，以整合相关性状，最大限度地提高预测精度。</p><p>第二个杠杆与基因分型有关。在作物育种项目中，选择基因分型技术来描述育种种质（训练和预测集）主要是由每个样品的基因分型成本驱动的（而不是真正由每个数据点的成本来体现）。事实上，使用现有工具（通过测序进行基因分型或固定SNP阵列）的每个样本的成本往往太高，无法在公共育种计划中常规使用。在中小型育种项目中，为了评估足够数量的个体，每个样品的成本必须在10美元左右或更少。在这个价格范围内，目前可以锁定的位点数量大约为1000-5000个SNPs。从长远来看，保持成本下降的一个选择是设计一个定制的基因分型检测，选择的SNP在目标育种群体中具有特殊的信息性。这将是一个比GBS或公共固定阵列更便宜的选择，并允许在基因型数据集中有更高密度的信息内容。定制的SNP panel还有一个额外的好处，即除了包含在该组中的全基因组标记外，还可能调查与育种计划相关的特定性状标记，从而允许对不一定优先用于MAS的已知等位基因的品系进行更广泛的QTL分析。事实上，根据基因分型服务提供者的能力，通过结合MAS和指纹鉴定来节省取样和DNA提取成本也不是没有道理的，比如用少数用于MAS的标记对群组进行筛选，然后将所选品系的DNA重新排列到一个新的平板上进行全基因组指纹鉴定。</p><p>通过使用低覆盖率的GBS，也可以实现低的基因分型成本。鉴于当测序深度降低时，GBS的局限性（数据缺失率高，杂合子位点的错误率高），这种方法不会有效地捕获杂合子位点，必须用于固定系的基因分型，再加上基于系谱中祖先系的高质量序列数据的高效填充框架。因此，这需要生物信息学方面的专业知识和获得高性能计算资源。</p><p>主要建议：</p><ul><li>考虑减少表型步骤的数量，只对试验的一个子集进行表型，或使用更便宜或更高通量的相关性状。</li><li>设计一个基因分型平台，该平台有一套专门为育种计划中管理的种质而选择的标记，并在服务供应商处部署。</li></ul><h2 id="4-irri灌溉系统育种计划的例子"><a class="markdownIt-Anchor" href="#4-irri灌溉系统育种计划的例子"></a> 4 IRRI灌溉系统育种计划的例子</h2><p>在此，我们给出了一个在积极的水稻育种计划中整合和使用基因组预测的实际例子。最近IRRI重新设计的灌溉系统育种计划为了解使用基因组预测的应用育种计划的关键因素提供了一个理想的背景。事实上，该计划以东南亚、南亚和东非为主要干预区域，代表了早期育种工作的直接衍生，导致了亚洲的绿色革命。因此，它最好地体现了为生产兼具高产潜力和适应不同环境条件的材料而做出的努力。</p><h3 id="41-从系谱育种到轮回基因组选择的转变"><a class="markdownIt-Anchor" href="#41-从系谱育种到轮回基因组选择的转变"></a> 4.1 从系谱育种到轮回基因组选择的转变</h3><p>基因组选择在IRRI育种项目中的应用分为两大类：组内预测（全同胞和半同胞预测其他全同胞和半同胞），以优化我们的测试策略；跨组预测（祖母和母亲预测女儿和孙女），以加速我们的育种周期，这两种方法都需要改变育种策略。首先，最重要的是，这两项应用都需要低成本地部署一种基因分型技术，以便对育种材料进行常规指纹鉴定。这个标记集（称为1k-RiCA扩增 panel）最近被开发出来，并填充了在我们的种质中具有特别信息的标记。公开的固定芯片基因分型技术不能很好地实现这一目的，因为这些芯片上的许多标记是为了在全球范围内区分种质而选择的，而且通常非常昂贵，多态性相对较少（或者更糟糕的是有偏好性的）。</p><p>随着标记panel的到位和在服务提供商处的部署，从近期来看，基因组选择最有用的应用是允许根据目标环境中的表现进行选择，而不是取决于与菲律宾环境（IRRI的总部所在地）对选择的相关反应。目前，该计划的资源每年产生约2000个新品系的第一阶段产量试验。由于IRRI的所有产量试验都是由国家农业研究伙伴进行的，在非洲、南亚和东南亚的多地产量试验中测试2000个品系的能力极其有限。到目前为止，早期的育种材料是根据在菲律宾的表现来选择的，少量的先进品系被送到区域地点进行测试和评估（图2）。采用全同胞和半同胞的基因组选择，以实现基于目标环境的直接选择，避免需要依赖间接选择。通过选择一个优化的队列子集并将其送到感兴趣的地区进行测试，来自感兴趣的特定地区的表型数据可用于预测其余队列在该地区的表现。通过这种方式，整个队列在某处接受测试，但没有一个个体在所有地方接受测试，因此可以向合作伙伴发送适合其独特条件的优秀品系的进展。然而，要做到这一点，需要找到资金来对每年约2000个新品系的整个队列进行指纹鉴定。为了使这种形式的基因组选择不增加成本，人们注意到菲律宾的测试策略是对品系进行3年的测试（图2，前方案）。通过取消中间的测试阶段并选择一组特定区域的品系进行预先测试，可以回收足够的资金来支付指纹鉴定的费用。</p><p><img src="Fig2" alt="Fig2" /></p><blockquote><p>图2 IRRI以前、现在和未来的灌溉系统的育种计划。这些计划之间的演变特点是基因组预测（GP）的整合和育种周期的缩短。基因组预测用红色表示，并附有在该地区进行表型分析以更新模型的相关个体数量。步骤的颜色与活动的地点相对应：菲律宾为绿色，有合作伙伴的地区为黄色。年份和季节（WS：雨季，DS：旱季）在左边表示。右边的数字表示每个步骤的人口规模。黑色粗箭头表示将最佳品系作为亲本回收。MAS：使用10-20个主要与抗病性有关的性状标记进行标记辅助选择。INGER：由IRRI领导的国际水稻遗传评估网络。</p></blockquote><p>对该计划具有更长期价值的基因组预测应用是实现跨组群预测，以便在区域测试之前将每个区域的优良品系回收到育种管道中，从而加速育种周期（图2，未来方案）。然而，这种预测需要一个更强大的、多年的数据集，包括祖先品系的区域表型数据，因为在需要进行预测时，来自新出现的候选品系的全同胞和半同胞的表型数据是不可用的。随着基因组预测的首次应用，该计划现在已经准备好开始生成预测新亲本所需的区域特定表型观察的多年期数据集。然而，为了使这种预测成为可能，需要对杂交策略进行更有针对性的操作。育种家做出的最重要的决定是根据相关性状的育种价值来选择和杂交亲本。由于IRRI没有对这一指标进行常规计算，我们的第一步是将历史数据收集到一个模型中，并对产量、成熟度和株高的育种值和可靠度进行尽可能的估计。其他重要性状的育种值，如谷物质量、抗病性和其他农艺性状，没有足够的常规收集或足够的地点来提供有意义的育种值估计。由于努力将数据迁移到B4R数据管理系统中，这一过程被大大加快了。由于我们绝大多数的历史品系都没有DNA指纹数据，储存在家谱管理系统中的系谱数据被用来估计相关系数。通过对我们历史数据的多年评估，可以确定一套独特的核心品系，其产量具有较高和可靠的育种价值，这将成为进一步育种和种质特征分析的基础。一旦确定，这组高育种价值的品系就会被打上指纹，然后用这些数据来估计有效种群大小，并用来估计其他性状（如直链淀粉含量或抗瘟疫性）的主要基因频率。这些指标将被用来指导后代的选择策略，并评估将新基因引入计划的风险/效益。</p><p>这一步骤虽然不是由基因组选择引起的，但却非常重要，因为随着核心种质的发展和特征化，该计划承诺主要在这个新的基因库中进行杂交以推动遗传增益。这种跨代的亲缘关系（以及对频繁引入新种质的厌烦）创造了多代组群的遗传连续性，使我们有能力使用祖先的表型数据来预测新创造的后代的表现。与这种关联性相对应的是交叉和群体发展的商业规则的制定。这些规则确保育种计划产生的新杂交，尽可能地使下一代的遗传变异最大化。它们还允许在每个队列中产生足够数量的全同胞和半同胞，从中可以获得预测能力。其中，业务规则包括承诺尽可能地与最近批次的品系进行杂交（而不是较早发布的品系），防止在10%以上的杂交中使用任何一个品系以避免变异性的瓶颈，完全避免子系，以便每个F2植物产生一个独特的F6品系，并确保每个杂交的足够的新固定品系进入第一阶段的产量试验，以便有合理的概率发现一个比该杂交的平均产量至少好一个标准差的新品系。</p><p>随着这两个基因组预测应用的进行，该计划从一个长周期的系谱苗圃变成了一个快速周期的基因组学育种战略。这一战略包括根据预定的商业规则进行杂交和设定种群规模目标，通过RGA方法产生新品系，在品系固定后采用MAS，并使用所选头排的批量收割来创造种子，运往区域地点进行测试。对所有地区的整个队列的预测将确保每个品系在每个地区都有观察或预测，从中确定一组核心的特定地区的优良品系，并运往合作伙伴进行第二阶段的产量试验评估和测试。随着各地区对品系队列的数据积累，以及原始核心品系集的后代和祖代开始填充管道，预测各队列的区域表现的能力将增长，直到有足够的数据可用于在第一阶段产量测试前识别新的亲本。</p><h3 id="42-育种计划的描述和基因组预测的整合"><a class="markdownIt-Anchor" href="#42-育种计划的描述和基因组预测的整合"></a> 4.2 育种计划的描述和基因组预测的整合</h3><p>绘制育种计划图是优化使用育种计划资源的一个关键组成部分，并了解基因组选择的切入点可以放在哪里。图2中总结的现行育种策略是2017年在IRRI启动的，目的是减少周期时间，并通过引入基因组预测来优化多环境评估。在这一战略中，大部分活动都是在菲律宾的IRRI总部进行的。在第一年，进行杂交（80-100），并使用专用的SNP标记对F1植株进行验证。在第二年，分离家族通过RGA从F2到F6进行SSD。在这个阶段，7500至10000个品系被推进：这相当于每个杂交的200-400个品系。每个杂交的群体大小是根据主要基因的预期分离来确定的。在第三年，在田间的幼穗行中对这些品系进行评估，以了解种子的增加情况和对均匀度、植物结构和成熟度的评价。同时，对这些品系进行基因分型，对每个育种管道优先考虑的主要基因位点进行标记辅助选择。这些基因包括直链淀粉含量的蜡质基因和一些主要病虫害的抗病基因（瘟病、细菌性叶枯病…）。第三年的第二季专门用于准备在各地区运输的种子。在第四年，使用少于1000个SNP标记的低密度平台对基于MAS和头排选择（1500-2000）的先进品系进行基因分型。同样的品系也在菲律宾IRRI总部的第一阶段产量试验中进行评估。同时，队列中的一个子集（250-300个品系）被送到南亚和东非的区域合作伙伴那里，对关键农艺性状（株高、开花时间、谷物产量）进行多环境评价。这个子集（训练集）被用来建立基因组预测模型，随后被用来在整个群组中选择高级别的优良品系。由于没有历史数据可用于建立可靠的基因组预测模型，该方案中基因组预测的整合依赖于使用半同胞或全同胞，以高度相关的训练集和预测集来最大化准确性。基因组预测模型用于选择下一周期的亲本品系，并为在育种计划第五年进行的第二阶段产量试验选择有希望的品系（30-40个）。这一阶段结束时表现最好的品系可以在国家品种发布系统中进行预先测试，也可以由各地区的合作伙伴在其育种计划中使用，以丰富其基因库。</p><p>在这一战略中，育种周期跨越5年，第四年将先进品系作为亲本进行回收（图2）。与IRRI以前实施的育种计划相比，周期时间缩短了2年。缩短周期时间是提高遗传增益率的一个关键因素。在这个计划中，减少周期的主要工具之一是RGA。这种方法很早就为人所知，2013年进行了优化，2014年在IRRI大规模实施。目前，基因组预测没有用于减少周期，主要用于提高区域环境中的选择强度和准确性，特别是产量。其主要原因是育种计划中缺乏适合基因组预测的历史数据。事实上，很少有育种品系经过持续的基因分型和表型来建立一个可靠的数据库。因此，目前的阶段是一个过渡阶段，目前产生的数据为一个数据库提供资料，该数据库将用于预测未来后代的表现（跨群组预测）。这在图2中被强调为未来计划。这种在田间评估前直接预测候选品种性能的能力将使我们能够将周期时间再减少2年，形成2年的育种周期。然而，这也带来了操作上的挑战，如在RGA期间确保每年以稳定的方式进行四代，在RGA结束时生产足够的种子以进行多环境试验，以及快速浏览进口/出口流程以确保种子及时到达合作伙伴处以便在主要季节种植。</p><h3 id="43-分析管道的一个实际例子"><a class="markdownIt-Anchor" href="#43-分析管道的一个实际例子"></a> 4.3 分析管道的一个实际例子</h3><p>在本节中，我们将介绍我们目前在IRRI用于进行基因组选择的分析管道。这与当前育种策略第四年的活动相对应（第一阶段产量试验，图2）。该分析管道分为三个主要步骤（图3）。</p><ul><li>训练集的选择。该步骤基于在育种计划中使用的优良种质中专门选择的具有信息量的SNP标记和Acdemir等人的优化方法，该方法使预测集的预测误差方差（PEV）最小。</li><li>单一试验分析。在这一步中，在几个地区的训练集上测量表型数据（株高、开花天数和籽粒产量），分别进行分析，以评估每个地点的数据质量，用混合模型估计基因型数值的空间调整，同时考虑到试验设计。</li><li>基因组预测分析。在这最后一步，用训练集的基因型和表型数据训练的GBLUP模型被用来预测所有未测试品系的基因组估计育种值（GEBVs）。</li></ul><p><img src="Fig3" alt="Fig3" /><br />图3 数据分析流程图代表了IRRI育种计划中每个育种周期的常规步骤。首先用SNP panel对整个队列（第一阶段产量试验）进行基因分型，并利用这些数据来选择训练群体（整个队列的子集）。然后在多环境试验（MET）中对该训练群体进行评估。用考虑到实验设计的混合模型来分析单一试验。单一试验的BLUPs与整个群体的标记信息相结合，然后用于计算品系的基因组估计育种值（GEBV)。</p><p>为了说明分析管道，以IRRI的灌溉系统育种计划的真实数据为例。分析是在R环境中进行的，并利用了用于混合模型分析的R软件包asreml（有许可证）或sommer（免费提供）以及专门为分析管道开发的函数和文献。我们选择了让用户根据自己的喜好在asreml和sommer之间进行选择的可能性。所有的R脚本和数据都在补充材料中提供（数据1、2和3）。</p><h4 id="431-训练集的选择"><a class="markdownIt-Anchor" href="#431-训练集的选择"></a> 4.3.1 训练集的选择</h4><p>在目前的育种计划中，基因组预测被用于群体内预测。为了确定在区域MET中进行表型的最佳子集（训练集），我们使用基于混合模型理论的优化方法，使预测误差方差最小。R软件包STPGA（用于通过遗传算法选择训练群体）中提供的这种方法需要将基因组关系矩阵（G矩阵）作为输入。在这个例子中，1722个品系的整个队列用1079个SNP标记进行基因分型。我们使用rrBLUP软件包，根据包含编码为[-1, 0, 1]的标记信息的基因型矩阵（geno_data）来计算G矩阵。然后，G矩阵与所需的训练集大小（sTS=300）和复制数（rep=5）一起被用作OptiTS函数的参数。复制的数量允许选择在不同的运行中最有代表性的个体纳入训练集，以避免遗传算法的次优解。为了评估训练集与整个队列的代表性，用G矩阵中的两个第一主成分来绘制个体（图4）。<br /><img src="Fig4" alt="Fig4" /></p><blockquote><p>图4 使用用于基因组预测的所有育种品系的分子标记数据进行主成分分析。橙色的三角形代表使用Acdemir等人的优化方法选择的品系，构成训练集。其余的品系（灰色圆圈）构成了预测集。</p></blockquote><h4 id="432-单一试验分析"><a class="markdownIt-Anchor" href="#432-单一试验分析"></a> 4.3.2 单一试验分析</h4><p>一旦确定了训练集，它就被送到区域合作伙伴那里，在MET中进行评估。在本案例研究中，使用了来自孟加拉国五个不同地点的实际试验数据。这些试验是在2020年的旱季（1-5月）进行的。每项试验包括362个育种品系，其中299个是训练组品系，其余的是来自前一批的先进品系和检查品种。所有的试验都采用了部分重复设计，20%的品系进行了重复。本例中使用了三个性状：株高（厘米）、开花天数和谷物产量（吨/公顷）。试验数据被上传到B4R数据库，该数据库已被IRRI采用来管理所有育种试验数据。从B4R数据库导出的每个地点的数据被用来进行单个试验分析（pheno_data对象）。这一步的目的是消除数据集的潜在误差，并利用试验设计从空间变化中进行调整。下面的混合模型（asreml或sommer）被用来获得每条线的BLUP和解压BLUP。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">model <span class="operator">&lt;-</span> asreml<span class="punctuation">(</span> fixed <span class="operator">=</span> trait <span class="operator">~</span> <span class="number">1</span> <span class="punctuation">,</span></span><br><span class="line"> random <span class="operator">=</span> <span class="operator">~</span> DESIGN_X <span class="operator">+</span> DESIGN_Y <span class="operator">+</span> GID<span class="punctuation">,</span></span><br><span class="line"> na.action <span class="operator">=</span> na.method<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;include&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"> data <span class="operator">=</span> dataset<span class="punctuation">)</span></span><br><span class="line">model <span class="operator">&lt;-</span> sommer<span class="operator">::</span>mmer<span class="punctuation">(</span>fixed <span class="operator">=</span> trait <span class="operator">~</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"> random <span class="operator">=</span> <span class="operator">~</span> DESIGN_X <span class="operator">+</span> DESIGN_Y <span class="operator">+</span> GID<span class="punctuation">,</span></span><br><span class="line"> rcov <span class="operator">=</span> <span class="operator">~</span> units<span class="punctuation">,</span></span><br><span class="line"> data <span class="operator">=</span> dataset<span class="punctuation">,</span></span><br><span class="line"> verbose <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>变量DESIGN_X和DESIGN_Y代表田间地头的坐标。变量GID代表基因型的ID。然后，计算出BLUP和解压后的BLUP值。单次试验分析被嵌入到一个名为single_trial_asreml或single_trial_sommer的函数中，该函数将格式化的表型原始数据作为输入，并返回一个带有几个变量的数据框，包括位置、性状、基因型ID、BLUP、去压BLUP和重复率（H2）。然后对所有地点和性状使用该函数来运行模型并检索BLUPs（图5a）。</p><p><img src="Fig5" alt="Fig5" /></p><blockquote><p>图5 单一试验分析和基因组预测分析的结果。面板a显示了五个伙伴试验地点的谷物产量、开花50%天数和株高的BLUP值的图谱。面板b显示了预测和训练集品系的谷物产量GEBV的分布。这些结果是用asreml分析得到。</p></blockquote><h4 id="433-基因组预测"><a class="markdownIt-Anchor" href="#433-基因组预测"></a> 4.3.3 基因组预测</h4><p>在基因组预测模型中使用了来自单次试验分析的训练组品系的解压BLUP值和由1722个品系组成的整个队列（训练组和预测组）的全基因组标志物基因型数据。全基因组标记数据被用来构建Sommer包的加性关系矩阵。在使用asreml进行GBLUP分析的情况下，再构建加性关系矩阵的逆矩阵。使用GBLUP模型计算每个品系的GEBV，其中每个地点的回归BLUP为响应变量，地点为固定效应，育种品系（gid）和G矩阵的倒数（invG）为随机效应。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">model <span class="operator">&lt;-</span> asreml<span class="punctuation">(</span>fixed <span class="operator">=</span> trait <span class="operator">~</span> <span class="number">1</span> <span class="operator">+</span> location<span class="punctuation">,</span></span><br><span class="line"> random <span class="operator">=</span> <span class="operator">~</span> vm<span class="punctuation">(</span>gid<span class="punctuation">,</span> invG<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"> data <span class="operator">=</span> dataset<span class="punctuation">)</span></span><br><span class="line">model <span class="operator">&lt;-</span> sommer<span class="operator">::</span>mmer<span class="punctuation">(</span> fixed <span class="operator">=</span> trait <span class="operator">~</span> <span class="number">1</span> <span class="operator">+</span> location<span class="punctuation">,</span></span><br><span class="line"> random <span class="operator">=</span> <span class="operator">~</span> vs<span class="punctuation">(</span>gid<span class="punctuation">,</span> Gu <span class="operator">=</span> G<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"> rcov <span class="operator">=</span> <span class="operator">~</span> vs<span class="punctuation">(</span>units<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line"> data <span class="operator">=</span> dataset<span class="punctuation">,</span></span><br><span class="line"> verbose <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>与单一位置分析类似，该模型被嵌入一个有两个参数的函数（gblup _asreml或gblup _sommer）中：第一个是单一位置分析的输出，第二个是G矩阵的逆。该函数的输出是一个包含整个队列的GEBV的表格（图5b）。然后，GEBV值与性状标记信息相结合，由育种者用于选择品系进行高级测试，同时也为下一个育种周期选择亲本。</p><h2 id="5-基因组预测在水稻改良中的其他应用"><a class="markdownIt-Anchor" href="#5-基因组预测在水稻改良中的其他应用"></a> 5 基因组预测在水稻改良中的其他应用</h2><p>在本章的前几部分，我们看到基因组选择需要方法学研究和精心设计的育种计划才能有效实施。在这最后一部分中，我们介绍了正在进行的有关将基因组预测用于水稻改良的发展。我们认为育种者必须了解即将到来的方法和工具，以便在这些方法和工具成熟时做好准备，在适当的时候将其纳入育种计划。</p><h3 id="51-用于预选育的遗传多样性的特征分析"><a class="markdownIt-Anchor" href="#51-用于预选育的遗传多样性的特征分析"></a> 5.1 用于预选育的遗传多样性的特征分析</h3><p>遗传多样性的描述和利用对于实现长期育种目标和保持育种群体的适应潜力非常重要。在对精英种质进行反复选择的情况下，新材料的加入在短期内威胁到遗传增益，因为它冲淡了通过连续的选择周期精心积累的高价值等位基因的影响。然而，从长远来看，由于选择以及负或中性连锁拖累或遗传漂移造成的遗传多样性损失，可以通过将遗传变异仔细引入精英库来补偿。为特定的育种目标鉴定最佳加入物是很费力的，因为它需要对大量不同的品系进行准确的表型分析，这些品系往往掩盖了低育种价值背景中的有价值的单倍型。在这种情况下，基因组预测可用于识别种质资源库中的优良品系，并应用于预育，其目的是在大量的品系中识别高潜力基因型。在水稻方面，大型基因组资源的可用性，如3000个水稻基因组或高密度水稻阵列panel，为使用基因组预测来确定相对于育种目标的有价值的基因型提供了独特的机会。</p><h3 id="52-用于杂交育种的异质群体的定义"><a class="markdownIt-Anchor" href="#52-用于杂交育种的异质群体的定义"></a> 5.2 用于杂交育种的异质群体的定义</h3><p>在杂交育种中，通常需要异质性群体来最佳地利用物种内的异质性。为此，杂交选择使种质结构成为遗传上不同的群体，当来自互补群体的个体进行杂交时，这些群体显示出卓越的杂交性能。与其他主要作物（如玉米）相反，水稻的杂交群体主要是根据与特定不育系的互补性来定义的，而不是根据由互补性杂交潜力定义的基因库来定义的。由于作为水稻多样性特征的强烈的种群结构被混淆为互补性基因库的异质性分化，这在水稻中变得更加复杂。由于不育性、对比性的适应性和主要谷物质量参数的分布非常不同，将祖先亚种群胁迫成异质性群体的努力，如两个主要类型（籼稻和粳稻）的情况，具有局限性。需要进一步研究，以确定异质性的自然模式，在某些情况下，基因组预测可以帮助这种探索。最近，有人提出在水稻中使用预测法来定义基于互补产量表现的异质性库。在这项基于真实数据的研究中，作者应用Zhao等人开发的方法，通过将所有独特的单交杂交种的预测性能与不同组大小的模拟退火算法相结合，检测产量的异质性模式。</p><h3 id="53-高通量表型和环境信息的整合"><a class="markdownIt-Anchor" href="#53-高通量表型和环境信息的整合"></a> 5.3 高通量表型和环境信息的整合</h3><p>基因组学在育种项目中取得的重大进展强化了这样一种观点，即表型分析仍然是遗传改良的瓶颈。这似乎是矛盾的，因为基因组选择的优势之一在于减少了一些表型分析步骤。此外，由于基因组预测，对更昂贵或更困难的性状（抗旱性、抗宿根性、谷物品质等）的选择可以更早地纳入育种计划，从而提高选择强度。这些观察结果使人们对高通量表型方法的兴趣越来越大。一些工具（RGB和多光谱相机、热传感器等）和平台（表型车、无人驾驶飞行器等）可用于野外和实验室表型，具有广泛的应用前景。当集成到一个基因组预测模型中时，高通量的表型数据可以大大增加预测的准确性。在表型选择的情况下，高通量近红外光谱数据甚至可以取代基因型数据，并提供类似的准确性。然而，为了在育种中发挥作用，高通量表型技术产生的大量数据需要储存在数据管理系统中，相对于人工表型的成本和选择精度进行适当的审核，并与正确的基因型数据相关联，如果它要改善决策过程。尽管近年来工具和分析管道已经发展起来，但这些方法的常规使用仍有重要的限制：获取多环境的田间数据，而不仅仅是来自中央研究站的数据，是否有能够处理大型时间序列数据集的数据管理系统，以及相关设备的初始成本。预计随着技术和法规的成熟，提供高通量表型服务的专门公司将出现，就像基因分型的情况一样。</p><p>除了高通量表型，更好地描述影响作物性能的环境因素将提高我们解释非遗传性变异来源的能力。这种 &quot;环境分型 &quot;是一个积极研究的领域，显示出巨大的前景。为了使允许高通量实时收集环境类型数据的技术真正有用，需要继续使数据管理和分析策略成熟，以便从这些数据集中提取信息。</p><h2 id="6-结论一个水稻育种家的观点"><a class="markdownIt-Anchor" href="#6-结论一个水稻育种家的观点"></a> 6 结论：一个水稻育种家的观点</h2><p>根据水稻和其他物种的文献，进行基因组预测的能力和将基因组选择应用于水稻育种项目的价值是无可置疑的。估计预测值的能力以及作为估计GEBVs基础的关键数据集和模型也是非常清楚的。水稻的标记资源和表型能力是存在的，即使是最偏远的育种组织此时也可以利用。此外，描述种群中数量性状变异如何遗传的规则已被很好地理解，在大多数情况下，无限小模型似乎适用于水稻的数量性状。要想获得这项技术的全部价值，还需要对水稻育种项目进行重新定位，即在一个确定的基因库中围绕短周期的轮回选择策略。在这一转变过程中，基因组预测还可以帮助改善队列内的选择，并节省田间评估的费用。因此，在大多数项目中，产生基因型数据或建立分析管道往往不是实施基因组选择的起点。必须首先制定明确的数据收集和管理的业务规则，明确规定亲本选择的最佳做法，并承诺在精英基因库中工作。除这些基础活动外，育种项目必须使其运作标准化和系统化，使资源得到优化，工作流程清晰，育种者不需要花费过多的时间来管理物流。田间工作需要更多地关注数据质量和数据收集，将选择决策保留到数据收集、分析和解释之后。常规基因分型的标记系统也是必要的，但必须发展到基因型数据对感兴趣的育种种质有具体的信息。</p><p>迄今为止，公开的水稻文献主要集中在与预测在水稻中是否有效或如何优化预测精度有关的问题上。很少有水稻文献涉及如何实际应用预测来提高遗传增益率。因此，在试图实现现代化的过程中，许多育种家陷入了 “概念证明的炼狱”，试图复制别人的分析。试图改善其策略的育种家将受益于考虑他们的计划是否奠定了适当的基础，然后仔细考虑在他们声明的育种策略中预测的入口是什么。商业育种计划的优势在于可以自由地将资源投入到前期的额外资本或运营支出中，以获取长期的价值。然而，由于预算通常是紧张的、固定的，或者需要国会批准的公共资助项目，对育种策略进行成本节约的调整（如采用稀疏的测试设计或实施快速的品系固定代数）可能会在短期内释放出资源，这些资源可以用于为完全的基因组预测育种策略奠定适当的基础。</p>]]></content>
      
      
      <categories>
          
          <category> Review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GS </tag>
            
            <tag> Review </tag>
            
            <tag> Rice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>概率分布</title>
      <link href="/2022/11/19/%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/"/>
      <url>/2022/11/19/%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="概率分布"><a class="markdownIt-Anchor" href="#概率分布"></a> 概率分布</h1><h2 id="伯努利分布"><a class="markdownIt-Anchor" href="#伯努利分布"></a> 伯努利分布</h2><p>伯努力分布(Bernoulli distribution，又名两点分布或者0-1分布)是一个离散型概率分布，为纪念瑞士科学家雅各布·伯努利而命名。可以用抛硬币来理解该分布的概念：只抛一次硬币。正面朝上的概率是p,反面朝上的概率是q=1-p。则：</p><p>其概率质量函数为:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>p</mi><mi>x</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mi>f</mi><mspace width="1em"/><mi>x</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>q</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mi>f</mi><mspace width="1em"/><mi>x</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">P(x)=p^x(1-p)^{1-x}=\begin{cases} p,\quad if\quad x= 1\\ q, \quad if\quad x= 0 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="二项分布"><a class="markdownIt-Anchor" href="#二项分布"></a> 二项分布</h2><p>二项分布也可以理解为抛硬币，假设抛硬币n次，其中正面朝上的概率是p，X代表正面朝上的次数，则X的概率分布是二项分布，记为X~B(n,p)，其概率质量函数为</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>p</mi><mi>x</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy="false">)</mo><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mi>f</mi><mspace width="1em"/><mi>x</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>q</mi><mo separator="true">,</mo><mspace width="1em"/><mi>i</mi><mi>f</mi><mspace width="1em"/><mi>x</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">P(x)=p^x(1-p)^{1-x}=\begin{cases} p,\quad if\quad x= 1\\ q, \quad if\quad x= 0 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>对于抛硬币，我们可以想象两种不同的过程。<br />第一种过程是我们最终的目的是要估计总体的参数，也就是p，也就是给我很多样本，让我估计这两个值。就相当于是让我抛硬币，抛很多次，记录每一次是正面朝上还是反面朝上，那么我抛的次数越多，最终得到的p的值就准确。<br />第二种就是高中数学常考的题目，就我们根据常识已经知道抛一次硬币的话，正面朝上的概率是1/2,也就是我们已经知道总体的参数了，然后给我说，我抛8次硬币，2正面朝上的概率是多少。这时候我们可以用概率质量函数来求P（x)=C2 8 (1/2) 2(1-1/2)6 。在这个过程中，我们求的是概率。</p><p>上面这两个过程分别是求似然和求概率的过程。第一个过程可以表示成为L（p|A),第二个过程可以表示为P（A|p)，这里面的p就是那个总体参数，A就是抛1次，2次，3次……这样的抛硬币的过程。<br />并且L（p|A)=P(A|p)。</p>]]></content>
      
      
      <categories>
          
          <category> 数学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 概率论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VCF合并</title>
      <link href="/2022/08/26/VCF%E5%90%88%E5%B9%B6/"/>
      <url>/2022/08/26/VCF%E5%90%88%E5%B9%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="vcf合并"><a class="markdownIt-Anchor" href="#vcf合并"></a> VCF合并</h1><p>vcf文件储存的是样本的变异信息文件，在同一批次分析中，如果不是采用joint calling的方式进行分析，最终会获得单个样本的变异数据。这种文件很难对同组不同样本进行差异分析，此处就需要对文件进行合并。针对不同的标记，可以采用不同的软件。</p><h2 id="snp"><a class="markdownIt-Anchor" href="#snp"></a> SNP</h2><p>对于标记信息是SNP的vcf文件合并，常常用到的软件有gatk、vcftools、bcftools。其中，最常见的应用场景是对不同样本的变异文件进行合并，此时我采用的是bcftools文件。由于bcftools合并vcf文件时，需要提前对所有的vcf文件进行压缩并创建索引，因此还会涉及到bgzip和tabix这两个软件的使用。示例如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">对vcf文件进行排序</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">picard.jar SortVcf I=test1.vcf O=test1.sort.vcf</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩为gz文件</span></span><br><span class="line">bgzip raw.vcf </span><br><span class="line">bgzip CZL.Par.vcf </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">建立索引</span></span><br><span class="line">tabix -p vcf raw.vcf.gz </span><br><span class="line">tabix -p vcf CZL.Par.vcf.gz </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">合并</span></span><br><span class="line">bcftools merge  raw.vcf.gz  CZL.Par.vcf.gz &gt; Par.vcf</span><br></pre></td></tr></table></figure><h2 id="sv"><a class="markdownIt-Anchor" href="#sv"></a> SV</h2><p>而对于SV标记信息构成的vcf文件，则往往采用SUVIVOR来对vcf文件进行合并。具体示例如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">首先, 将VCF文件名输出到一个文件中:</span></span><br><span class="line">ls *vcf &gt; sample_files</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后, 生成合并的VCF结果:</span></span><br><span class="line">SURVIVOR merge sample_files 1000 2 1 1 0 30 sample_merged.vcf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数示意</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1000表示允许合并的SV间的距离最大为1000bp;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2表示仅输出2个工具均鉴定出的SV;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1表示仅输出2个工具鉴定出的同类型的SV;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1表示仅输出2个工具鉴定出的同方向的SV;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">30表示仅考虑长度在30bp以上的SV</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SNP </tag>
            
            <tag> VCF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SV_genotype</title>
      <link href="/2022/07/05/SV-genotype/"/>
      <url>/2022/07/05/SV-genotype/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="sv_genotype"><a class="markdownIt-Anchor" href="#sv_genotype"></a> SV_genotype</h1><h2 id="软件安装"><a class="markdownIt-Anchor" href="#软件安装"></a> 软件安装</h2><p>从https://github.com/hall-lab/svtyper下载整个文件夹，然后上传到服务器，然后解压，随后按以下命令安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">unzip svtyper-master.zip</span><br><span class="line"><span class="built_in">cd</span> svtyper</span><br><span class="line">conda create --channel bioconda --name Py27 pysam numpy scipy cytoolz python=2.7</span><br><span class="line">pip install pytest-runner</span><br><span class="line">pip install pytest==4.6.4</span><br><span class="line">pip install -e .</span><br><span class="line">make <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>当出现以下界面时，则表示安装成功：</p><p><img src="image-20220705094406092.png" alt="image-20220705094406092" /></p>]]></content>
      
      
      <categories>
          
          <category> GWAS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SV </tag>
            
            <tag> genotype </tag>
            
            <tag> GWAS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手动构造plink文件并转为vcf文件</title>
      <link href="/2022/06/04/%E6%89%8B%E5%8A%A8%E6%9E%84%E9%80%A0plink%E6%96%87%E4%BB%B6%E5%B9%B6%E8%BD%AC%E4%B8%BAvcf%E6%96%87%E4%BB%B6/"/>
      <url>/2022/06/04/%E6%89%8B%E5%8A%A8%E6%9E%84%E9%80%A0plink%E6%96%87%E4%BB%B6%E5%B9%B6%E8%BD%AC%E4%B8%BAvcf%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BLUP计算及相关报错解决</title>
      <link href="/2022/06/02/BLUP%E8%AE%A1%E7%AE%97%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/"/>
      <url>/2022/06/02/BLUP%E8%AE%A1%E7%AE%97%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>最佳线性无偏预测（Best Linear Unbiased Prediction，简称BLUP）对多环境数据进行整合，去除环境效应，得到个体稳定遗传表型。BLUP是表型处理的常用做法。R包lme4中lmer函数是BLUP分析常用的方法，在很多NG文章都引用了该方法。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>pacman<span class="punctuation">)</span></span><br><span class="line">p_load<span class="punctuation">(</span>tidyverse<span class="punctuation">,</span> lme4<span class="punctuation">,</span> data.table<span class="punctuation">)</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;H:/BaiduNetdiskWorkspace/program/GS/input/Study/pop2/input&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 多环境无重复</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">df <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;DC2_phe.txt&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="image-20220602151058338.png" alt="image-20220602151058338" /></p><p>随后，按不同性状对数据进行整理</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df1 <span class="operator">&lt;-</span> na.omit<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">HD_15 <span class="operator">&lt;-</span> df1<span class="punctuation">[</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">%&gt;%</span></span><br><span class="line">    pivot_longer<span class="punctuation">(</span>cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> names_to <span class="operator">=</span> <span class="string">&quot;env&quot;</span><span class="punctuation">,</span> values_to <span class="operator">=</span> <span class="string">&quot;HD&quot;</span><span class="punctuation">)</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> HD_15</span><br><span class="line">data1<span class="operator">$</span>f_id <span class="operator">=</span> factor<span class="punctuation">(</span>data1<span class="operator">$</span>f_id<span class="punctuation">)</span></span><br><span class="line">data1<span class="operator">$</span>env <span class="operator">=</span> factor<span class="punctuation">(</span>data1<span class="operator">$</span>env<span class="punctuation">)</span></span><br><span class="line">data1<span class="operator">$</span>HD <span class="operator">=</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>data1<span class="operator">$</span>HD<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="image-20220602151525441.png" alt="image-20220602151525441" /></p><p>随后，进行分析：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">blp1<span class="operator">=</span>lmer<span class="punctuation">(</span>HD<span class="operator">~</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>env<span class="punctuation">)</span><span class="operator">+</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>f_id<span class="punctuation">)</span><span class="operator">+</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>env<span class="operator">:</span>f_id<span class="punctuation">)</span><span class="punctuation">,</span>data<span class="operator">=</span>data1<span class="punctuation">,</span></span><br><span class="line">         control<span class="operator">=</span>lmerControl<span class="punctuation">(</span>check.nobs.vs.nlev <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.rankZ <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nlev.gtr.1 <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.nRE<span class="operator">=</span><span class="string">&quot;ignore&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>blp1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>出现如下报错：</p><p><img src="image-20220602152129698.png" alt="image-20220602152129698" /></p><p><a href="https://zhuanlan.zhihu.com/p/343113243">N2 | 一年多点如何计算BLUP值 - 知乎 (zhihu.com)</a>提到是因为<code>env</code>的方差组分为0导致的，因此在这里移除<code>(1|env)</code>,并重新运行如下代码：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">blp1<span class="operator">=</span>lmer<span class="punctuation">(</span>HD<span class="operator">~</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>f_id<span class="punctuation">)</span><span class="operator">+</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>env<span class="operator">:</span>f_id<span class="punctuation">)</span><span class="punctuation">,</span>data<span class="operator">=</span>data1<span class="punctuation">,</span></span><br><span class="line">         control<span class="operator">=</span>lmerControl<span class="punctuation">(</span>check.nobs.vs.nlev <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.rankZ <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nlev.gtr.1 <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.nRE<span class="operator">=</span><span class="string">&quot;ignore&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>blp1<span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="image-20220602152545988.png" alt="image-20220602152545988" /></p><p>报错解除，随后利用ranef函数获取随机效应值,blups返回一个list,包含env和lines的随机效应值即BLUP。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">blups1<span class="operator">=</span> ranef<span class="punctuation">(</span>blp1<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>blups1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#blups$lines代表effect值；blp@beta代表均值，用均值+effect的值表示BLUP值，也可以直接用effect值表示BLUP，这里采用前者作为blup值。</span></span><br><span class="line"></span><br><span class="line">lines1<span class="operator">=</span>blups1<span class="operator">$</span>f_id<span class="operator">+</span>blp1<span class="operator">@</span>beta</span><br><span class="line">res1<span class="operator">=</span>data.frame<span class="punctuation">(</span>id<span class="operator">=</span>rownames<span class="punctuation">(</span>lines1<span class="punctuation">)</span><span class="punctuation">,</span>blup<span class="operator">=</span>lines1<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>res1<span class="punctuation">)</span><span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;ID&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;HD15&#x27;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>res1<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="image-20220602152008537.png" alt="image-20220602152008537" /></p><p>但是，当运行另外一个性状时，又出现了新的警告信息：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HD_16 <span class="operator">&lt;-</span> df1<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">%&gt;%</span> pivot_longer<span class="punctuation">(</span>cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    names_to <span class="operator">=</span> <span class="string">&quot;env&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    values_to <span class="operator">=</span> <span class="string">&quot;HD&quot;</span><span class="punctuation">)</span></span><br><span class="line">data2 <span class="operator">&lt;-</span>HD_16</span><br><span class="line">data2<span class="operator">$</span>f_id<span class="operator">=</span>factor<span class="punctuation">(</span>data2<span class="operator">$</span>f_id<span class="punctuation">)</span></span><br><span class="line">data2<span class="operator">$</span>env <span class="operator">=</span>factor<span class="punctuation">(</span>data2<span class="operator">$</span>env<span class="punctuation">)</span></span><br><span class="line">data2<span class="operator">$</span>HD  <span class="operator">=</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>data2<span class="operator">$</span>HD<span class="punctuation">)</span></span><br><span class="line">blp2<span class="operator">=</span>lmer<span class="punctuation">(</span>HD<span class="operator">~</span><span class="operator">+</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>f_id<span class="punctuation">)</span><span class="operator">+</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">|</span>env<span class="operator">:</span>f_id<span class="punctuation">)</span><span class="punctuation">,</span>data<span class="operator">=</span>data2<span class="punctuation">,</span></span><br><span class="line">         control<span class="operator">=</span>lmerControl<span class="punctuation">(</span>check.nobs.vs.nlev <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.rankZ <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nlev.gtr.1 <span class="operator">=</span> <span class="string">&quot;ignore&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             check.nobs.vs.nRE<span class="operator">=</span><span class="string">&quot;ignore&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>blp2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="image-20220602150526185.png" alt="image-20220602150526185" /></p>]]></content>
      
      
      
        <tags>
            
            <tag> GS </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GWAS相关知识</title>
      <link href="/2022/05/26/GWAS%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/05/26/GWAS%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>popLDdecay</title>
      <link href="/2022/05/17/popLDdecay/"/>
      <url>/2022/05/17/popLDdecay/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="连锁不平衡分析"><a class="markdownIt-Anchor" href="#连锁不平衡分析"></a> 连锁不平衡分析</h1><p>当位于某一座位的特定等位基因与另一座位的某一等位基因同时出现的概率不等于群体中 因随机分布的两个等位基因同时出现的概率时，就称这两个座位处于连锁不平衡状态 （linkage disequilibrium）</p><ol><li>LD 的计算方法与度量：</li></ol><p>设有两个位点 A、B，等位基因分别为 A、a 和 B、b，在群体中对应的频率分别为 f(A)、f(a) 和 f(B)、f(b)；两个位点共有 4 种单倍型 AB、Ab、aB 和 ab，对应的频率分别为 f(AB)、f(Ab)、 f(aB)和 f(ab)；<br />则有基本量：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{ab} = f(AB) - f(A)* f(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p><p>从 <code>0-1</code>，度量值越高，LD 越高，一般情况下，如果两个位点连锁，连锁程度也越强。</p><p>特殊说明： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>反映了 LD 的不同方面。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 包括了重组和突变，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>只包括重组史。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>能更准确地估测重组差异，但样本较小时，低频率等位基因组合可能无法观测到，导致 LD 强度被高 估，所以 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>不适合小样本群体研究。 当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，处于完全连锁平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mi mathvariant="normal">≠</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} ≠ 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，处于连锁不平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">D_{ab} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 时，处于完全连锁不平衡状态;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mfrac><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">|D&#x27;| = \frac{D_{ab}}{min(f(AB), f(ab))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.414191em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.894191em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.41586em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p>当 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ab} &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mfrac><msub><mi>D</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mi>b</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mi>B</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">|D&#x27;| = \frac{D_{ab}}{min(f(Ab), f(aB))}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.414191em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.894191em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.41586em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><mi>D</mi><mi>a</mi><mi>b</mi></mrow><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">r^2 = \frac{Dab}{f(A)*f(a)*f(B)*f(b)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.400108em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">A</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">)</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">b</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">|D&#x27;| = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r^2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 时处于完全连锁平衡状态 ;</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|D&#x27;| = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r^2 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 时处于完全连锁不平衡状态</p><ol start="2"><li>LD 衰减影响因素</li></ol><ul><li><p>不同物种，LD 是不同基因座上等位基因非随机组合。但 LD 随世代的增加、重组次数的 增加而不断下降。所以，那些繁殖力强、时代间隔短的物种（例如，昆虫），其 LD 衰减的 速度是非常快的。</p></li><li><p>同一物种，不同群体类型，由于其遗传背景不同，LD 衰减速度也存在很大的差异。驯 化群体，群体遗传多样性下降，位点间的相关性（连锁程度）加强。所以，驯化程度越高，选择强度越大的群体，LD 衰减速越慢。同样，自然选择、遗传漂变导致的群体遗传多样性 下降，也会减慢 LD 衰减的速度。</p></li><li><p>在染色体的位置，染色体在不同位置的 LD 衰减距离是不同的。通常着丝粒区更难重组， 所以 LD 衰减更慢，而基因组上那些受选择的区域相比普通的区域，LD 衰减速度也是更慢 的。</p></li></ul><ol start="3"><li>应用：</li></ol><ul><li><p>LD 衰减速度，对群体特性的评估，与群体类型的特性（自然群体还是驯化群体，选择 强度大小）是相关的。</p></li><li><p>全基因组关联分析所用标记量 =基因组大小/LD 衰减距离</p></li><li><p>GWAS，功能 SNP 和 tag SNP，GWAS 检测到显著关联的区间后，则可以通过进一步绘 制局部的 LD   单体型块图，来进一步判断显著相关的 SNP 和目标基因间是否存在强 LD 关系。</p></li><li><p>STRUCTURE 分析的时候理论上必须输入不相关的位点。那么，就可以通过预估 LD 衰 减到 0.1 的距离，来判断标记间的距离必须大于多少才能保证标记间不具相关性（LD&lt;0.1）。</p></li></ul><h2 id="连锁不平衡分析-poplddecay"><a class="markdownIt-Anchor" href="#连锁不平衡分析-poplddecay"></a> 连锁不平衡分析-PopLDdecay</h2><p>LD decay 在群体遗传研究中是最重要和常见的分析内容之一，是衡量 LD 水平的重要指标。 特别在自花授粉的作物中，LD 衰减不仅能够反映作物驯化和育种历史，还能显示基因流现 象、选择区域等。 传统 LD 处理软件 Haploview 可以用来计算 LD、单倍型等，但上百万 snp 标记的计算会消 耗大量资源，本地运行往往会由于运行内存不足而崩溃。PopLDdecay 是一种简单有效的 LD 衰减分析软件，可计算和绘图（不是特别理想），以压缩包形式输入输出内容，相比其他软 件，更适合大数据量的计算和分析</p><h3 id="安装"><a class="markdownIt-Anchor" href="#安装"></a> 安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/BGI-shenzhen/PopLDdecay.git</span><br><span class="line"><span class="built_in">chmod</span> 755 configure;</span><br><span class="line">./configure;</span><br><span class="line">make;</span><br><span class="line"><span class="built_in">mv</span> PopLDdecay  ./bin/;</span><br></pre></td></tr></table></figure><h3 id="计算ld"><a class="markdownIt-Anchor" href="#计算ld"></a> 计算LD</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#2.1 For gatk VCF file deal, run PopLDdecay direct</span></span><br><span class="line">./bin/PopLDdecay  -InVCF  SNP.vcf.gz  -OutStat LDdecay   </span><br><span class="line"><span class="comment">#2.2 For plink [.ped .map], chang plink 2 genotype first  2) run PopLDdecay  </span></span><br><span class="line">perl bin/mis/plink2genotype.pl -inPED in.ped -inMAP in.map -outGenotype out.genotype ;   </span><br><span class="line">./bin/PopLDdecay -InGenotype out.genotype -OutStat LDdecay </span><br><span class="line"><span class="comment">#2.3 To Calculate the subgroup GroupA LDdecay in VCF Files   # put GroupA sample name into GroupA_sample.list</span></span><br><span class="line">./bin/PopLDdecay -InVCF -OutStat -SubPop GroupA_sample.list</span><br></pre></td></tr></table></figure><h3 id="绘图"><a class="markdownIt-Anchor" href="#绘图"></a> 绘图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#3.1 For one Population</span></span><br><span class="line">perl bin/Plot_OnePop.pl -inFile LDdecay.stat.gz -output Fig</span><br><span class="line"><span class="comment">#3.2 For one Population muti chr  # List Format [chrResultPathWay]</span></span><br><span class="line">perl bin/Plot_OnePop.pl -inList Chr.ReslutPath.List -output Fig</span><br><span class="line"><span class="comment">#3.3 For muti Population #List Format:[Pop.ResultPath  PopID ]</span></span><br><span class="line">perl bin/Plot_MutiPop.pl -inList Pop.ReslutPath.list -output Fig</span><br></pre></td></tr></table></figure><h3 id="实例"><a class="markdownIt-Anchor" href="#实例"></a> 实例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PopLDdecay -InVCF test.impute.vcf -OutStat <span class="built_in">test</span> -MaxDist 1000 -MAF 0.05 -OutType 2 </span><br><span class="line"><span class="comment">#-InVCF 输入 vcf 文件 </span></span><br><span class="line"><span class="comment">#-OutStat 输出前缀 </span></span><br><span class="line"><span class="comment">#-MaxDist 窗口 </span></span><br><span class="line"><span class="comment">#-MAF 次要等位基因频率 </span></span><br><span class="line"><span class="comment">#-OutType 输出类型 </span></span><br></pre></td></tr></table></figure><p><img src="HHZ1.stat.LD.stat.gz.png" alt="" /></p><p>主要结果是 test.stat.gz</p><p>其中每一列的含义如下：</p><p>第一列：距离</p><p>第二列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 值</p><p>第三列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>值</p><p>第四列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 值求和</p><p>第五列：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msup><mi>D</mi><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|D&#x27;|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>值求和</p><p>第六列：SNP 对</p><h3 id="ld-衰减图"><a class="markdownIt-Anchor" href="#ld-衰减图"></a> LD 衰减图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rm <span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line">LD <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;./HHZ1.stat.LD.stat&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="operator">=</span>LD<span class="punctuation">,</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Dist<span class="operator">/</span><span class="number">1000</span><span class="punctuation">,</span>y<span class="operator">=</span>Mean_r.2<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.3368881</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.3366881</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span>lineend <span class="operator">=</span> <span class="string">&quot;butt&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">67</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.33668881</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">67</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.3368881</span><span class="punctuation">)</span><span class="punctuation">,</span>label<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;(67,0.3368881)&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>nudge_x <span class="operator">=</span> <span class="number">0.002</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>y<span class="operator">=</span><span class="built_in">expression</span><span class="punctuation">(</span>r<span class="operator">^</span><span class="punctuation">&#123;</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="punctuation">,</span>title <span class="operator">=</span> <span class="string">&quot;LD decay&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;Distance&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_x_continuous<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span><span class="number">300</span><span class="punctuation">)</span><span class="punctuation">,</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">300</span><span class="punctuation">,</span><span class="number">50</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> p<span class="operator">+</span>theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 使主标题居中</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure><h2 id="连锁不平衡分析-plink"><a class="markdownIt-Anchor" href="#连锁不平衡分析-plink"></a> 连锁不平衡分析-plink</h2><p>plink 是进行连锁不平衡分析的主要工具，一般情况下需要两个基本的输入文件，后缀分别 为 ped 和 map。</p><h3 id="格式转换"><a class="markdownIt-Anchor" href="#格式转换"></a> 格式转换</h3><p>利用 plink 首先将 vcf 格式的文件转换为 ped 和 map 文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plink --vcf test.impute.vcf --recode ped --out <span class="built_in">test</span> </span><br></pre></td></tr></table></figure><p>test.ped</p><p><img src="CZL.ped.png" alt="" /></p><p>前 6 列分别代表 Family ID、Individual ID、Paternal ID、Maternal ID、 Sex (1=male; 2=female; other=unknown)、Phenotype，后面的每一行，每两列代表一种基因型。</p><p>test.map</p><p><img src="CZL1.map.png" alt="" /></p><p>分别代表染色体，SNP，遗传距离，物理位置</p><h3 id="ld-分析"><a class="markdownIt-Anchor" href="#ld-分析"></a> LD 分析</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">plink --map test.map --ped test.ped --noweb --allow-no-sex --allow-extra-chr --missing-genotype 0 --maf 0.05 --r2 --ld-window 999999 --ld-window-kb 1000 --ld-window-r2 0 --out <span class="built_in">test</span> </span><br><span class="line"><span class="comment">#--map map 文件 </span></span><br><span class="line"><span class="comment">#--ped ped 文件 </span></span><br><span class="line"><span class="comment">#--noweb 不进行网络检查 </span></span><br><span class="line"><span class="comment">#--allow-extra-chr 允许其他格式的染色体编号 </span></span><br><span class="line"><span class="comment">#--missing-genotype 缺失基因型编码 </span></span><br><span class="line"><span class="comment">#--maf 次要等位基因频率 </span></span><br><span class="line"><span class="comment">#--r2 输出 r2 </span></span><br><span class="line"><span class="comment">#--ld-window 窗口内 SNP 数目 </span></span><br><span class="line"><span class="comment">#--ld-window-kb 窗口大小 </span></span><br><span class="line"><span class="comment">#--ld-window-r2 窗口内最小 SNP </span></span><br><span class="line"><span class="comment">#--out 输出前缀 </span></span><br></pre></td></tr></table></figure><p>主要结果 test.ld</p><p><img src="CZL.LD.ld.png" alt="" /></p><p>各列含义如下：</p><ul><li><p>第一列代表第一个 SNP 所在染色体</p></li><li><p>第二列代表第一个 SNP 的物理位置</p></li><li><p>第三列代表第一个 SNP</p></li><li><p>第四列代表第二个 SNP 所在染色体</p></li><li><p>第五列代表第二个 SNP 的物理位置</p></li><li><p>第六列代表第二个 SNP</p></li><li><p>第七列代表 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>  值</p></li></ul><h3 id="结果整理"><a class="markdownIt-Anchor" href="#结果整理"></a> 结果整理</h3><p>利用脚本 decay_chrom.pl 进行结果汇总，代码如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">perl decay_chrom.pl test.ld test.r2 1000 </span><br><span class="line">test.ld 代表 LD 分析的结果文件 </span><br><span class="line">test.r2 整理汇总后的输出文件 </span><br><span class="line">1000 代表窗口大小，单位是 kb </span><br></pre></td></tr></table></figure><p><img src="CZL.r2.png" alt="" /></p><p>各列含义如下：</p><ul><li><p>第一列代表区域</p></li><li><p>第二列代表区域内 SNP 数目</p></li><li><p>第三列代表区域内 SNP 之间的距离</p></li><li><p>第四列代表区域内 SNP 之间的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>  值</p></li></ul><h3 id="ld-衰减图-2"><a class="markdownIt-Anchor" href="#ld-衰减图-2"></a> LD 衰减图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;E:/BaiduNetdiskWorkspace/NGS/LD/&quot;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;HHZ1.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;Test.gvcf.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>x <span class="operator">&lt;-</span> <span class="punctuation">(</span>data<span class="operator">$</span>Total_dis<span class="operator">*</span><span class="number">1000</span><span class="punctuation">)</span><span class="operator">/</span><span class="punctuation">(</span>data<span class="operator">$</span>Total_num<span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>y <span class="operator">&lt;-</span> <span class="punctuation">(</span>data<span class="operator">$</span>Total_R2<span class="punctuation">)</span><span class="operator">/</span><span class="punctuation">(</span>data<span class="operator">$</span>Total_num<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> data<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span>y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span>base_line_size <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span>base_size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.2728428</span> <span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.2728428</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span>lineend <span class="operator">=</span> <span class="string">&quot;butt&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>xend<span class="operator">=</span><span class="number">316</span><span class="punctuation">,</span>yend<span class="operator">=</span><span class="number">0.2728428</span><span class="punctuation">)</span><span class="punctuation">,</span>data <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">316</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="number">0.29</span><span class="punctuation">)</span><span class="punctuation">,</span>label<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;(316,0.27)&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>nudge_x <span class="operator">=</span> <span class="number">0.002</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Distance(kb)&quot;</span><span class="punctuation">,</span>y <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span>r<span class="operator">^</span><span class="punctuation">&#123;</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="punctuation">,</span>title <span class="operator">=</span> <span class="string">&quot;LD decay&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getvalue<span class="operator">=</span><span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">,</span>v<span class="operator">=</span><span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">&gt;=</span>v <span class="operator">&amp;</span> <span class="built_in">min</span><span class="punctuation">(</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">&lt;=</span>v<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">2</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>y<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">      <span class="keyword">if</span><span class="punctuation">(</span>y<span class="punctuation">[</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">&gt;</span>v <span class="operator">&amp;</span> y<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="operator">&lt;</span>v<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    approx<span class="punctuation">(</span>y<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">:</span>i<span class="punctuation">]</span><span class="punctuation">,</span>x<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">:</span>i<span class="punctuation">]</span><span class="punctuation">,</span>xout<span class="operator">=</span>v<span class="punctuation">)</span><span class="operator">$</span>y</span><br><span class="line">  <span class="punctuation">&#125;</span><span class="keyword">else</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="literal">NA</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;Test.LD.r2&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">$</span>x <span class="operator">&lt;-</span> data<span class="operator">$</span>Total_dis<span class="operator">*</span><span class="number">1000</span><span class="operator">/</span>data<span class="operator">$</span>Total_num</span><br><span class="line">data<span class="operator">$</span>y <span class="operator">&lt;-</span> data<span class="operator">$</span>Total_R2<span class="operator">/</span>data<span class="operator">$</span>Total_num</span><br><span class="line">y_half <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>data<span class="operator">$</span>y<span class="punctuation">,</span>na.rm<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">2</span></span><br><span class="line">decay_value <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>getvalue<span class="punctuation">(</span>data<span class="operator">$</span>x<span class="punctuation">,</span>data<span class="operator">$</span>y<span class="punctuation">,</span>y_half<span class="punctuation">)</span><span class="punctuation">,</span>getvalue<span class="punctuation">(</span>data<span class="operator">$</span>x<span class="punctuation">,</span>data<span class="operator">$</span>y<span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">result <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>y_half<span class="punctuation">,</span>decay_value<span class="punctuation">)</span> </span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>result<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;R2_half&quot;</span><span class="punctuation">,</span><span class="string">&quot;R2_half_Decay_Value&quot;</span><span class="punctuation">,</span><span class="string">&quot;0.1_Decay_Value&quot;</span><span class="punctuation">)</span> </span><br><span class="line">result</span><br></pre></td></tr></table></figure><h2 id="最终结果"><a class="markdownIt-Anchor" href="#最终结果"></a> 最终结果</h2><p>最终结果如下：<br /><img src="LD-decay.svg" alt="" /></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>rrBLUP使用</title>
      <link href="/2022/04/26/rrBLUP%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/04/26/rrBLUP%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="amat"><a class="markdownIt-Anchor" href="#amat"></a> A.mat</h2><p>函数<code>A.mat</code>从标记估计真实关系矩阵(<code>A</code>)。对于没有缺失数据的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>高密度标记，<code>A.mat</code>使用VanRaden ( 2008 )建议的第一个公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mrow><mi>W</mi><msup><mi>W</mi><mo mathvariant="normal">′</mo></msup></mrow><mrow><mn>2</mn><munder><mo>∑</mo><mi>k</mi></munder><mrow><msub><mi>p</mi><mi>k</mi></msub><msub><mi>q</mi><mi>k</mi></msub></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">A=\frac{WW&#x27;}{2\sum_k{p_kq_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4146020000000004em;vertical-align:-0.9857100000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.428892em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1863979999999999em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9857100000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其1中，其中W的等位基因调用以群体均值为中心。Endelman和Jannink ( 2012 )研究表明，该公式具有可取的性质，其平均对角元素为1 + f，其中f为当前种群的近交系数。</p><h3 id="missing-marker-data"><a class="markdownIt-Anchor" href="#missing-marker-data"></a> Missing marker data</h3><p>当基因型缺失时，<code>A.mat</code>有两个插补选项。一种是用该标记的总体均值来替换缺失数据，这对于SNP芯片通常遇到的低水平缺失数据是足够的。对于基因分型测序(GBS)标记而言，缺失数据的水平更高。针对这种情况，<code>A.mat</code>可以利用基于多元正态分布( 波兰等国 2012年 )的EM算法估计关系矩阵。</p><p>为了说明EM算法，我在Poland等人( 2012 )<a href="https://www.crops.org/publications/tpg/supplements/5/tpg12-06-0006-dataset-s2.gz">发布的补充文件</a>中下载了GBS数据,下面的R代码读取文件并将标记调用转换为rrBLUP期望的{ -1，0，1 }格式：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GBS<span class="operator">&lt;-</span>read.csv<span class="punctuation">(</span><span class="string">&quot;tpg12-06-0006-dataset-s2&quot;</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>as.is<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>row.names<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span>  </span><br><span class="line">parse.GBS <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="punctuation">&#123;</span> </span><br><span class="line">    unique.x <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>x<span class="punctuation">)</span> </span><br><span class="line">    alleles <span class="operator">&lt;-</span> setdiff<span class="punctuation">(</span>unique.x<span class="punctuation">,</span>union<span class="punctuation">(</span><span class="string">&quot;H&quot;</span><span class="punctuation">,</span><span class="string">&quot;N&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">    y <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="built_in">length</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span>alleles<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="operator">-</span><span class="number">1</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span>alleles<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> </span><br><span class="line">    y<span class="punctuation">[</span>which<span class="punctuation">(</span>x<span class="operator">==</span><span class="string">&quot;N&quot;</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span> </span><br><span class="line">    <span class="built_in">return</span><span class="punctuation">(</span>y<span class="punctuation">)</span> </span><br><span class="line"><span class="punctuation">&#125;</span> </span><br><span class="line">X <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>GBS<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span>parse.GBS<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>X<span class="punctuation">)</span>  </span><br><span class="line">frac.missing <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>X<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="keyword">function</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">&#123;</span><span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="built_in">length</span><span class="punctuation">(</span>z<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span> </span><br><span class="line"><span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>frac.missing<span class="operator">&lt;</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">hist<span class="punctuation">(</span>frac.missing<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>缺失数据小于50 %的标记有16K个，这足以估计254个株系的关系矩阵。因为我在一个符合UNIX的多处理器系统上运行这个代码，所以我可以使用12个核心来加速EM算法：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>rrBLUP<span class="punctuation">)</span> </span><br><span class="line">system.time<span class="punctuation">(</span>A1 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>X<span class="punctuation">,</span>impute.method<span class="operator">=</span><span class="string">&quot;EM&quot;</span><span class="punctuation">,</span>n.core<span class="operator">=</span><span class="number">12</span><span class="punctuation">,</span>max.missing<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>EM算法在执行过程中显示收敛序列，它表示关系系数的均方根误差。默认停止准则为0.02，但这可以随参数‘tol’( 输入 <code>?A.mat</code>获取更多信息 )而改变。在这种情况下，算法在达到0.0151时停止，只需不到一分钟。如果只有1个核心可用，只需省略n . core选项，默认情况下只使用1个核心。</p><p>用均值代替EM算法，语法是<code>system.time(A2 &lt;- A.mat(X,max.missing=0.5))</code>,用均值输入更快，而且在许多情况下，它似乎与EM算法和其他更复杂的GEBV精度方法一样。但是，与EM算法( 波兰等国 2012年 )相比，均值化后的育种值更容易出现偏差。对两个矩阵的平均对角元素的比较表明，在标记调用的杂合度约为1 %的情况下，EM算法的结果更接近期望1+f≈2：</p><h3 id="shrinkage-estimation-of-a"><a class="markdownIt-Anchor" href="#shrinkage-estimation-of-a"></a> Shrinkage estimation of A</h3><p><code>A.mat</code>的另一个独特之处是收缩估计，可以使用低密度标记，例如384SNP芯片。当行数与标记数相当或超过标记数时，方程1可能不是关系矩阵的最优估计。Endelman和Jannink ( 2012 )提议将估计缩小到( 1 + f ) I，收缩强度选择以最小化均方误差。</p><p>为了说明这一点，我将使用一套599个小麦品系，在BLR软件包(  Pérez等人 2010年 )的1279个DArT标记基因型：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>BLR<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>wheat<span class="punctuation">)</span></span><br><span class="line">M <span class="operator">&lt;-</span> 2<span class="operator">*</span>X<span class="operator">-</span><span class="number">1</span>  <span class="comment">#convert markers to &#123;-1,1&#125;</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>M<span class="punctuation">)</span></span><br><span class="line">A1 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">A2 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">[</span><span class="punctuation">,</span>sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">1279</span><span class="punctuation">,</span><span class="number">384</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">A3 <span class="operator">&lt;-</span> A.mat<span class="punctuation">(</span>M<span class="punctuation">[</span><span class="punctuation">,</span>sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">1279</span><span class="punctuation">,</span><span class="number">192</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>shrink<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GS </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>circos plot-1</title>
      <link href="/2021/11/01/circos-plot-1/"/>
      <url>/2021/11/01/circos-plot-1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="数据准备"><a class="markdownIt-Anchor" href="#数据准备"></a> 数据准备</h1><h2 id="1-文件格式"><a class="markdownIt-Anchor" href="#1-文件格式"></a> 1、文件格式</h2><ul><li>KARYOTYPE</li><li>线、散点图、直方图和热图</li><li>tile</li><li>text</li><li>links</li></ul><h4 id="karyotype染色体"><a class="markdownIt-Anchor" href="#karyotype染色体"></a> KARYOTYPE——染色体</h4><p>以水稻的karyotype文件为例，主要包括：名字、标签、起始和终止位置以及颜色</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">chr     -       Chr1    Chr1    0       43270923        Chr1</span><br><span class="line">chr     -       Chr2    Chr2    0       35937250        Chr2</span><br><span class="line">chr     -       Chr3    Chr3    0       36413819        Chr3</span><br><span class="line">chr     -       Chr4    Chr4    0       35502694        Chr4</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>可以在 <code>data/karyotype</code> 文件夹下找到常用的参考基因组的 <kbd>karyotype</kbd> 文件</p><h4 id="线-散点图-直方图和热图"><a class="markdownIt-Anchor" href="#线-散点图-直方图和热图"></a> 线、散点图、直方图和热图</h4><p>线、散点图、直方图和热图都是2D数据，具体格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#chrstartendvalue[options]</span><br><span class="line">Chr1    0       100000  0</span><br><span class="line">Chr1    100000  200000  0</span><br><span class="line">Chr1    200000  300000  0</span><br><span class="line">Chr1    300000  400000  0</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="tile"><a class="markdownIt-Anchor" href="#tile"></a> tile</h4><p><kbd>tile</kbd> 定义为同一染色体上的区间，用来显示覆盖率相关信息，如 <kbd>reads</kbd>或 <kbd>clones</kbd> 等信息,具体格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chr start end [options]</span></span><br><span class="line">Chr 0 100000 </span><br></pre></td></tr></table></figure><h4 id="text"><a class="markdownIt-Anchor" href="#text"></a> text</h4><p>与基因组位置相关的文本信息，如文本标签</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#chr start end label [options]</span></span><br><span class="line">hs5 50 75 ABC</span><br></pre></td></tr></table></figure><p>如果你要显示多个词，可以用 <code>tab</code> 作为分隔符</p><h4 id="links"><a class="markdownIt-Anchor" href="#links"></a> links</h4><p>同一染色体或不同染色体不同区域之间的关系，可以绘制成线条或丝带的形状</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># chr1 start1 end1 chr2 start2 end2 [options]</span><br><span class="line">hs1 200 300 hs10 1100 1300</span><br><span class="line">hs7 50 150 hs 5000 6000 color=blue</span><br></pre></td></tr></table></figure><p><code>binlinks</code>, <code>bundlelinks</code> 和 <code>filterlinks</code> 工具 可以用于操作和分析 <code>link</code> 文件.</p><h2 id="2-options选项"><a class="markdownIt-Anchor" href="#2-options选项"></a> 2、options选项</h2><p>在<code>&lt;plot&gt;</code>, <code>&lt;link&gt;</code>,或 <code>&lt;highlight&gt;</code>块中定义的特定数据点的任何格式化选项，如形状、大小、颜色等，都通过输入文件来定义</p><p>在上面展示的例子中的 <code>[options]</code> 字符可以通过以逗号分隔的键值对的字符串来设置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end var1=value1,var2=value2,...</span><br></pre></td></tr></table></figure><p>而对于解析为列表值，如 <code>RGB</code> 值，需要用 <code>()</code>、<code>[]</code> 来分隔</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end color=(R,G,B)</span><br></pre></td></tr></table></figure><h5 id="有无数据值时的-options"><a class="markdownIt-Anchor" href="#有无数据值时的-options"></a> 有无数据值时的 options</h5><p>输入文件中有与基因组位置相关的值时，<code>options</code> 域在第 <code>5</code> 列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end value options</span><br></pre></td></tr></table></figure><p>如果没有值，<code>options</code> 域在第 <code>4</code> 列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr start end options</span><br></pre></td></tr></table></figure><h2 id="3-文件分隔符"><a class="markdownIt-Anchor" href="#3-文件分隔符"></a> 3、文件分隔符</h2><p>默认情况下是以空白符作为分隔符，想要更改分隔符,可以在配置文件中定义 <code>file_delim</code> 参数</p><p>最好是将参数放在 <code>etc/housekeeping.conf</code> 文件中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># etc/housekeeping.conf</span><br><span class="line">file_delim = \t</span><br></pre></td></tr></table></figure><p>如果想要设置多词文本标签，需要设置分隔符为 <code>tab</code>，将会应用于所有输入文件（数据文件和核型文件 <code>karyotype</code>）</p><h2 id="4-文件位置"><a class="markdownIt-Anchor" href="#4-文件位置"></a> 4、文件位置</h2><p>如果指定特定文件的绝对路径，<code>circos</code> 将不会去其他地方寻找文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file = /path/to/file.txt</span><br></pre></td></tr></table></figure><p>如果文件 <code>/path/to/file.txt</code> 不存在，将会引发错误</p><p>如果使用相对路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file = data/file.txt</span><br></pre></td></tr></table></figure><p><code>circos</code> 将会试图以下面的顺序在多个目录中查找</p><ul><li>在 <code>data_path</code> 下的所有目录</li><li><code>CWD/</code></li><li><code>CWD/etc</code></li><li><code>CWD/data</code></li><li><code>CWD/../</code></li><li><code>CWD/../etc</code></li><li><code>CWD/../data</code></li><li><code>CWD/../..</code></li><li><code>CWD/../../etc</code></li><li><code>CWD/../../data</code></li></ul><p><code>CWD</code> 为当前目录，推荐使用相对路径的方式，这样的可移植性较好</p><p>建议你将数据文件放置一个单独的文件夹中 <code>(e.g. data/)</code>，与配置文件区分开</p><hr /><p>本文参考了生信学习手册的内容，在此表示感谢，以下是原文链接<a href="https://mp.weixin.qq.com/s/Bj2bJKDevNMX3MbMO5TYPw">circos 学习手册</a></p>]]></content>
      
      
      <categories>
          
          <category> circos </category>
          
      </categories>
      
      
        <tags>
            
            <tag> circos </tag>
            
            <tag> rice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>circos 圈图</title>
      <link href="/2021/10/20/circos-%E5%9C%88%E5%9B%BE/"/>
      <url>/2021/10/20/circos-%E5%9C%88%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="环境配置"><a class="markdownIt-Anchor" href="#环境配置"></a> 环境配置</h2><p>建议在Linux环境下配置Circos，之后只要用conda就能配置好分析环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="comment">## circos</span></span><br><span class="line">conda create -c bioconda -n circos circos</span><br></pre></td></tr></table></figure><p>测试软件安装结果</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试circos</span></span><br><span class="line">conda activate circos</span><br><span class="line"><span class="comment"># 确认安装</span></span><br><span class="line">circos -V</span><br><span class="line"><span class="comment"># 显示如下</span></span><br><span class="line"><span class="comment"># circos | v 0.69-8 | 15 Jun 2019 | Perl 5.026002</span></span><br></pre></td></tr></table></figure><p>可以从http://circos.ca/software/download/下载官方的教程文件，分别是</p><ul><li><a href="http://circos.ca/distribution/circos-course-2017.tgz">circos-course-2017.tgz</a></li><li><a href="http://circos.ca/distribution/circos-tutorials-current.tgz">circos-tutorials-current.tgz</a></li></ul><h2 id="快速开始"><a class="markdownIt-Anchor" href="#快速开始"></a> 快速开始</h2><p>第一步，先新建一个文件夹，用于存放本次分析的所有数据和配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p my_first_circos &amp;&amp; <span class="built_in">cd</span> my_first_circos</span><br></pre></td></tr></table></figure><p>然后用<code>vim karyotype.tair10.txt</code>编辑文本，新增如下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr - chr1 chr1 0 30427617 black</span><br><span class="line">chr - chr2 chr2 0 19698289 black</span><br><span class="line">chr - chr3 chr3 0 23459830 black</span><br><span class="line">chr - chr4 chr4 0 18585056 black</span><br><span class="line">chr - chr5 chr5 0 26975502 black</span><br></pre></td></tr></table></figure><p>之后创建一个<code>circos.conf</code>文件，用于增加各类配置参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> circos.conf</span><br></pre></td></tr></table></figure><p>用<code>vim circos.conf</code>，增加我们的第一条记录，染色体信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">karyotype = karyotype.tair10.txt</span><br></pre></td></tr></table></figure><p>然而要想真正的出图，还需要增加至少以下配置语句才行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;ideogram&gt;</span><br><span class="line">&lt;spacing&gt;</span><br><span class="line">default = 0.005r</span><br><span class="line">&lt;/spacing&gt;</span><br><span class="line">radius           = 0.90r</span><br><span class="line">thickness        = 20p</span><br><span class="line">fill             = <span class="built_in">yes</span></span><br><span class="line">stroke_color     = dgrey</span><br><span class="line">stroke_thickness = 2p</span><br><span class="line">&lt;/ideogram&gt;</span><br><span class="line"></span><br><span class="line">&lt;image&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/image.conf&gt;&gt;</span></span><br><span class="line"><span class="string">&lt;/image&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;&lt;include</span> etc/colors_fonts_patterns.conf&gt;&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/housekeeping.conf&gt;&gt;</span></span><br></pre></td></tr></table></figure><p>在当前路径下运行<code>circos -conf circos.conf</code>, 最终效果图如下</p><p>虽然图比较丑，但是至少我们成功运行了人生第一次的circos, 这就相当于买了一套毛坯房，后面要做的事情就是不断装修。</p><p>比如说，我们至少可以让不同染色体拥有不同的颜色，修改之前的<code>karyotype.tair10.txt</code>中的最后一列</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr - chr1 chr1 0 30427617 chr1</span><br><span class="line">chr - chr2 chr2 0 19698289 chr2</span><br><span class="line">chr - chr3 chr3 0 23459830 chr3</span><br><span class="line">chr - chr4 chr4 0 18585056 chr4</span><br><span class="line">chr - chr5 chr5 0 26975502 chr5</span><br></pre></td></tr></table></figure><p>在当前路径下运行<code>circos -conf circos.conf</code>, 最终效果图如下</p><p>这就引出了第一个知识点，<strong>配色</strong>。</p><p>为了实现配色，需要<code>circos.conf</code>文件了有一个和配色有关的语句</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="string">include etc/colors_fonts_patterns.conf&gt;&gt;</span></span><br></pre></td></tr></table></figure><p>这里<code>&lt;&lt;&gt;&gt;</code>表示通过<strong>相对路径</strong>的方式加载另外一个配置文件，它的实际路径是和<code>circos</code>所在目录同级的<code>etc</code>,可用下面语句看到<code>colors_fonts_patterns.conf</code>的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">circos_path=$(<span class="built_in">dirname</span> `<span class="built_in">which</span> circos`)</span><br><span class="line">less <span class="variable">$&#123;circos_path%bin&#125;</span>/etc/colors_fonts_patterns.conf</span><br></pre></td></tr></table></figure><p>你会发现，这个文件里还嵌套其他的配置文件。最终通过层层排查，你才知道<code>etc/colors.ucsc.conf</code>才是实际定义我们填写的颜色名的文件，而颜色的定义如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr1  = 153,102,0</span><br><span class="line">chr2  = 102,102,0</span><br><span class="line">chr3  = 153,153,30</span><br><span class="line">chr4  = 204,0,0</span><br><span class="line">chr5  = 255,0,0</span><br></pre></td></tr></table></figure><p>还有一个问题，为什么这里用的是两个尖括号<code>&lt;&lt;</code>，而不是一个尖括号<code>&lt;</code>呢？这是因为<code>&lt;</code>已经被用于分隔不同的语句块，如下语句就表示<code>etc/image.conf</code>里的配置信息是用来调整和<code>image</code>有关的配置，而不是去调整<code>ideogram</code>的配置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;image&gt;</span><br><span class="line">&lt;&lt;<span class="string">include etc/image.conf&gt;&gt;</span></span><br><span class="line"><span class="string">&lt;/image&gt;</span></span><br></pre></td></tr></table></figure><hr /><p>以上是快速开始部分，后续将会在此基础上，做出发表级别的图。</p>]]></content>
      
      
      <categories>
          
          <category> 绘图 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> circos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>遗传分析中常见群体</title>
      <link href="/2021/10/18/%E9%81%97%E4%BC%A0%E5%88%86%E6%9E%90%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%BE%A4%E4%BD%93/"/>
      <url>/2021/10/18/%E9%81%97%E4%BC%A0%E5%88%86%E6%9E%90%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%BE%A4%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="遗传分析中常见群体"><a class="markdownIt-Anchor" href="#遗传分析中常见群体"></a> 遗传分析中常见群体</h1><p>群体是具有一些共同特征个体的集合。遗传学研究中提出的遗传交配设计有很多，根据情报的数量大致可以划分为双亲群体、多亲群体等。</p><blockquote><p>本文引用自<a href="http://blog.sciencenet.cn/home.php?mod=space&amp;uid=1094241&amp;do=blog&amp;id=1093008">科学网—扒一扒遗传分析中群体那些事儿 - 马省伟的博文 (sciencenet.cn)</a></p></blockquote><h3 id="双亲群体"><a class="markdownIt-Anchor" href="#双亲群体"></a> 双亲群体</h3><p>双亲衍生群体是自孟德尔杂交实验重新发现以来，植物遗传研究中使用最为广泛的群体类型。双亲杂交设计一般从两个具有明显表型差异的纯和基因型亲本（分别用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>）开始，在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">P_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>间杂交产生<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代，并由此衍生出了常见的以下群体</p><ul><li>杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">F_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>群体及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mrow><mn>2</mn><mo>:</mo><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">F_{2:3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mrel mtight">:</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：由杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>自交产生，共显性标记（codominant marker）在群体内的分离比为1:2:1，显性标记（dominant marker）则为3:1</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>群体：杂种<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代与亲本回交获得</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>I</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">RIL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">L</span></span></span></span>群体（重组自交系）：将F2群体不同个体连续自交或同胞交配，使家系内个体基因型趋于纯合，属于永久性定位群体；RIL群体的分离比率为1:1；单粒传法是常见的RIL群体创制方法，但需要多年多世代的工作。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>I</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">NIL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">L</span></span></span></span>群体（近等基因系群体）：群体内不同个体的染色体绝大部分区间完全相同，只有少数几个或一个区间彼此存在差异；NIL群体可以将多个QTL位点分解成单个孟德尔遗传因子，将数量性状转化为质量形状，从而可以对主效QTL进行精细定位和图位克隆。</li><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">DH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span></span></span></span>群体：DH群体是配子基因型经染色体加倍形成的，不同个体基因型稳定，属于永久作图群体。该群体标记的分离比是1:1；该类型的群体不仅可以对质量性状进行定位，也可以对数量性状进行多年多点的重复实验，是研究基因型和环境互作的理想材料。</li></ul><h3 id="多亲群体"><a class="markdownIt-Anchor" href="#多亲群体"></a> 多亲群体</h3><p>顾名思义，多亲群体指的就是利用多亲本开展遗传交配设计，创建遗传群体并进行遗传研究，常见的有<strong>巢式关联作图群体</strong>（NAM，nested association mapping）和<strong>多亲本高代互交群体</strong>（MAGIC，multiparent advanced generation inter-crossing）。</p><ul><li><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mi>A</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">NAM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>群体：其实就是不同的亲本材料分别与同一材料（CP, commonparent）做杂交，再在杂交后代内部分别进行连续自交（单粒传法）或同胞交配以创制不同的一系列重组自交系（RIL）。这些重组自交系均含有一个相同亲本（CP），不同的重组自交系都是基于两个亲本所创制的。NAM群体结合了双亲群体和自然群体（natural population）的优点，可以用来做关联-连锁不平衡分析（joint linkage–linkage disequilibrium mapping）。第一个NAM群体是利用玉米自交系B73作为共有亲本分别与25份不同自交系杂交和自交而创建的，一共包括25个RIL群体和大约5000个株系。该群体已经被成功用于玉米开花时间或者抗叶枯病等方面的研究。</p></li><li><p><kbd>MAGIC</kbd>群体:由多个双亲进行两两进行杂交，来自于两个亲本的杂交<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代再分别两两杂交产生双交（double hybrids）后代，两个双交后代<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>再进一步杂交，这样产生的后代就分别来自与8个不同的亲本。这个杂交过程可以持续进行，以尽可能包含更多的亲本材料。最后这些复合杂交的后代经过自交或染色体加倍而形成一系列RIL群体或DH群体。MAGIC群体最早是在拟南芥（<em>Arabidopsis thaliana</em>）中创制的，大约来自于19个不同拟南芥材料相互交配的后代，一共包含527个重组自交系，该群体被用来进行拟南芥QTL性状的精细定位。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 遗传 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>how to start GO &amp; KEGG by clusterProfiler</title>
      <link href="/2021/10/09/how-to-start-GO-KEGG-by-clusterProfiler/"/>
      <url>/2021/10/09/how-to-start-GO-KEGG-by-clusterProfiler/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="1-go分析"><a class="markdownIt-Anchor" href="#1-go分析"></a> 1、GO分析</h3><h3 id="2-kegg分析"><a class="markdownIt-Anchor" href="#2-kegg分析"></a> 2、KEGG分析</h3><blockquote><p>Y叔的clusterProfiler可能是目前KEGG富集分析最好的软件，因为能爬取最新的KEGG在线版数据库，而不是用不再更新的KEGG.db。</p></blockquote><h4 id="enrichkegg-函数介绍"><a class="markdownIt-Anchor" href="#enrichkegg-函数介绍"></a> enrichKEGG 函数介绍：</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enrichKEGG<span class="punctuation">(</span>gene<span class="punctuation">,</span> organism <span class="operator">=</span> <span class="string">&quot;hsa&quot;</span><span class="punctuation">,</span> keyType <span class="operator">=</span> <span class="string">&quot;kegg&quot;</span><span class="punctuation">,</span> pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span>  </span><br><span class="line">        pAdjustMethod <span class="operator">=</span> <span class="string">&quot;BH&quot;</span><span class="punctuation">,</span> universe<span class="punctuation">,</span> minGSSize <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> maxGSSize <span class="operator">=</span> <span class="number">500</span><span class="punctuation">,</span>  </span><br><span class="line">        qvalueCutoff <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> use_internal_data <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gene：基因名，需与keyType对应</span></span><br><span class="line"><span class="comment"># organism：从http://www.genome.jp/kegg/catalog/org_list.html获取</span></span><br><span class="line"><span class="comment"># keyType:基因命名方式，包括：kegg、ncbi-geneid、ncbi-proteinid 和uniprot</span></span><br></pre></td></tr></table></figure><h4 id="分析思路"><a class="markdownIt-Anchor" href="#分析思路"></a> 分析思路</h4><h5 id="organism"><a class="markdownIt-Anchor" href="#organism"></a> organism</h5><p>首先确定自己要研究的物种，在这里我们研究对象是水稻。所以打开<a href="https://www.genome.jp/kegg/catalog/org_list.html">KEGG Organisms: Complete Genomes</a>，搜索Oryza sativa</p><p><img src="image-20211009163706228.png" alt="" /></p><p>上图左边的osa和dosa就是要填到organism里的参数，选择其中一个就行，这里推荐<kbd>dosa</kbd></p><h5 id="keytypes"><a class="markdownIt-Anchor" href="#keytypes"></a> keyTypes</h5><p>可以把enrichKEGG当作浏览器，试出合适的keytypes。</p><p><img src="image-20211009215233046.png" alt="" /></p><p>因此，我们需要提供的keyType是<code>kegg</code>，基因名应该类似于<code>Os06t0664200-01</code>.</p><blockquote><p>按照同样的套路，对于<code>osa</code>的kegg命名方式应该<code>3131385</code>能够用于在NCBI上查找的gene ID。</p></blockquote><h5 id="基因id转换"><a class="markdownIt-Anchor" href="#基因id转换"></a> 基因ID转换</h5><p>通常情况下，我们获取的基因ID往往是<kbd>LOC_Os01g24710</kbd>或<kbd>Os01g0348900<br /></kbd>的形式，那么应该怎么转换为<kbd>Os01g0348900-01</kbd>呢？<br />首先去相关数据库https://shigen.nig.ac.jp/rice/oryzabase/ 下载id文件，通过一行命令完成转换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> salt.txt | xargs -i awk <span class="string">&#x27;BEGIN&#123;FS=&quot;\t&quot;&#125;  $0 ~/&#123;&#125;/ &#123; print $2&#125;&#x27;</span> rice_id_20140620174522.txt &gt; RAP_id.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GO </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GO </tag>
            
            <tag> KEGG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件按列合并及调整列的顺序</title>
      <link href="/2021/08/17/%E6%96%87%E4%BB%B6%E6%8C%89%E5%88%97%E5%90%88%E5%B9%B6%E5%8F%8A%E8%B0%83%E6%95%B4%E5%88%97%E7%9A%84%E9%A1%BA%E5%BA%8F/"/>
      <url>/2021/08/17/%E6%96%87%E4%BB%B6%E6%8C%89%E5%88%97%E5%90%88%E5%B9%B6%E5%8F%8A%E8%B0%83%E6%95%B4%E5%88%97%E7%9A%84%E9%A1%BA%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h3 id="按列合并文件"><a class="markdownIt-Anchor" href="#按列合并文件"></a> 按列合并文件</h3><p>paste</p><blockquote><p>语法： paste file1 file2</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file1.txt</span></span><br><span class="line"></span><br><span class="line">a   1</span><br><span class="line">b   1</span><br><span class="line">c   3</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file2.txt</span></span><br><span class="line"></span><br><span class="line">a   4</span><br><span class="line">b   5</span><br><span class="line">c   6</span><br></pre></td></tr></table></figure><p>合并：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">paste</span> file1 file2 &gt; file3.txt</span></span><br><span class="line">cat file3.txt</span><br><span class="line">a   1   a   4</span><br><span class="line">b   1   b   5</span><br><span class="line">c   3   c   6</span><br></pre></td></tr></table></figure><p>默认的分割符是制表符，也可以指定其他分隔符</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">paste  -d &#x27;_&#x27; file1.txt file2.txt</span><br><span class="line">a   1_a   4</span><br><span class="line">b   1_b   5</span><br><span class="line">c   3_c   6</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="调整列的顺序"><a class="markdownIt-Anchor" href="#调整列的顺序"></a> 调整列的顺序</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk &#x27; &#123; t = $1; $1 = $2; $2 = t; print; &#125; &#x27; input_file</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="去除m"><a class="markdownIt-Anchor" href="#去除m"></a> 去除^M</h3><p>首先查看文件有没有<kbd>^M</kbd>,<code>cat -v filename</code>,如果有可以采用以下几种方式</p><ul><li>dos_2unix</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dos2unix /fileth/name</span><br></pre></td></tr></table></figure><ul><li>sed</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sed --in-place=&#x27;&#x27; &#x27;s./^M//g&#x27; /path/to/file</span><br></pre></td></tr></table></figure><h3 id="修改文件的间隔符"><a class="markdownIt-Anchor" href="#修改文件的间隔符"></a> 修改文件的间隔符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sampleID.txt|tr &quot;\t&quot; &quot;,&quot; &gt; sampleID_form.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> awk paste </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客的编辑</title>
      <link href="/2021/08/17/%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%BC%96%E8%BE%91/"/>
      <url>/2021/08/17/%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%BC%96%E8%BE%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="博客的创建"><a class="markdownIt-Anchor" href="#博客的创建"></a> 博客的创建</h2><blockquote><p>hexo 语法</p></blockquote><p>创建文章前要先选定模板，在hexo中也叫做布局。hexo支持三种布局（layout）：post(默认)、draft、page。<br />首先进入博客的主目录,执行以下命令<code>hexo n &quot;my first blog&quot;</code>,会默认使用post布局，然后自动在source_posts目录生成一个my first blog.md文件：</p><p>当然此时可以指定布局: <code>hexo n [layout_name] draft1</code>,此时你就在创建你的一篇草稿.<br />如果此时你想要插入图片,可以使用如下的语法<code>![](image.jpg)</code></p><p><img src="%E6%8A%AC%E5%A4%B4.png" alt="" /></p><p>如果插入视频,</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?aid=39807850&cid=69927212&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"> </iframe></div><p>当编辑完成之后，就可以把文章推送到_posts目录下：<code>hexo publish &lt;file_name&gt;</code></p><h3 id="常用命令"><a class="markdownIt-Anchor" href="#常用命令"></a> 常用命令</h3><ul><li><strong>清除缓存：</strong><code>hexo clean</code></li><li><strong>生成静态文件：</strong><code>hexo generate</code>可简写为 <code>hexo g</code></li><li><strong>启动服务器：</strong><code>hexo server</code>或者 <code>hexo s</code> 常用参数：<code>-p（--port）</code>重设端口</li><li><strong>部署：</strong><code>hexo deploy</code>可简写为<code>hexo d</code>，用于将网站部署到服务器上。（暂时用不到，目前都是在本地，后面我们将博客托管到<code>GitHub Pages</code>或<code>Gitee Pages</code>时才会用到此命令）<br />常用参数：<code>-g（--generate）</code>，<code>hexo d -g</code>部署前预先生成静态文件，等同于 <code>hexo g -d</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
